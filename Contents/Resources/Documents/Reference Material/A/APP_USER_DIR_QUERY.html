<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="Routines (alphabetical)|Routines: A" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-US" xml:lang="en-US" madcap:pathtohelpsystem="../../../" madcap:helpsystemfilename="idl.xml" madcap:searchtype="Stem">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   APP_USER_DIR_QUERY
  </title>
  <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
  <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
  <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../idl_CSH.html#Reference Material/A/APP_USER_DIR_QUERY.html" style="">
    Open topic with navigation
   </a>
  </p>
  <div class="MCBreadcrumbsBox_0">
   <span class="MCBreadcrumbsPrefix">
    <![CDATA[ ]]>
   </span>
   <a class="MCBreadcrumbsLink" href="../../images/ref_part1.html">
    Routines (alphabetical)
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="A_list.html">
    Routines: A
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <span class="MCBreadcrumbs">
    APP_USER_DIR_QUERY
   </span>
  </div>
  <h1 class="Routine">
   <a name="A_850317933_756649">
   </a>
   <a name="A_850317933_19868">
   </a>
   APP_USER_DIR_QUERY
  </h1>
  <p madcap:conditions="Reference Material.Online_Help_Only">
   <madcap:conditionaltext madcap:conditions="Reference Material.Online_Help_Only">
    <a class="MCXref_Heading_0" href="#A_850317933_1011733">
     Syntax
    </a>
    |
    <a class="MCXref_Heading_0" href="#A_850317933_1011735">
     Return Value
    </a>
    |
    <a class="MCXref_Heading_0" href="#A_850317933_1011737">
     Arguments
    </a>
    |
    <a class="MCXref_Heading_0" href="#A_850317933_1011748">
     Keywords
    </a>
    |
    <a class="MCXref_Heading_0" href="#A_850317933_1011776">
     Example
    </a>
    |
    <a class="MCXref_Heading_0" href="#A_850317933_1011786">
     Version History
    </a>
    |
    <a class="MCXref_Heading_0" href="#A_850317933_1011788">
     See Also
    </a>
   </madcap:conditionaltext>
  </p>
  <p>
   The
   <a name="kanchor91">
   </a>
   APP_USER_DIR_QUERY function is used to locate existing
   <i>
    application user directories
   </i>
   previously created by the
   <a class="MCXref_Heading_0" href="APP_USER_DIR.html#A_850317933_1008659">
    APP_USER_DIR
   </a>
   function. An IDL application can use APP_USER_DIR_QUERY to locate the directories that were used by other (presumably older) versions of itself. A newly installed version can use this information to migrate application settings or data from another version in order to preserve the user’s customizations.
  </p>
  <p>
   To use APP_USER_DIR_QUERY, your application should call it with the same values of the
   <i>
    AuthorDirname
   </i>
   and
   <i>
    AppDirname
   </i>
   arguments, and the exact set of RESTRICT keywords, used to call APP_USER_DIR. In this configuration, APP_USER_DIR_QUERY will return the same application user directory returned by APP_USER_DIR. To search for other
   <i>
    related
   </i>
   application user directories, use the QUERY keywords to specify which of the attributes specified in the call to APP_USER_DIR should be allowed to take on any value.
  </p>
  <p>
   As an example, suppose your application creates user application directories that depend on the version of the application and on the operating system in use. You might want to locate all directories created for a specific application version, regardless of the operating system in use when the directory was created.
  </p>
  <p class="Tip" madcap:autonum="&lt;b&gt;Tip: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Tip:
     </b>
    </span>
   </span>
   The application user directory for the current system is always one of the values returned by APP_USER_DIR_QUERY. In the common example of an application that wants to migrate data from a different version, the path for the current system is not desired. Use the EXCLUDE_CURRENT keyword to suppress it from the results.
  </p>
  <h2 class="API">
   <a name="A_850317933_1011733">
   </a>
   <a name="A_850317933_1011733_PageTOC_APP_USER_DIR_QUERY_">
   </a>
   Syntax
  </h2>
  <p class="Syntax">
   <i>
    Result
   </i>
   = APP_USER_DIR_QUERY(
   <i>
    AuthorDirname
   </i>
   ,
   <i>
    AppDirname
   </i>
   [,&#160;
   <a class="MCXref_Heading_0" href="#A_850317933_1011749">
    COUNT
   </a>
   =variable] [,&#160;/
   <a class="MCXref_Heading_0" href="#A_850317933_1011751">
    EXCLUDE_CURRENT
   </a>
   ][,&#160;/
   <a class="MCXref_Heading_0" href="#A_850317933_1011762">
    QUERY_APPVERSION
   </a>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#A_850317933_1011764">
    QUERY_ARCH
   </a>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#A_850317933_1011766">
    QUERY_FAMILY
   </a>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#A_850317933_1011768">
    QUERY_FILE_OFFSET_BITS
   </a>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#A_850317933_1011770">
    QUERY_IDL_RELEASE
   </a>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#A_850317933_1011772">
    QUERY_MEMORY_BITS
   </a>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#A_850317933_1011774">
    QUERY_OS
   </a>
   ] [
   <a class="MCXref_Heading_0" href="#A_850317933_1011753">
    RESTRICT Keywords
   </a>
   ] )
  </p>
  <h2 class="API">
   <a name="A_850317933_1011735">
   </a>
   <a name="A_850317933_1011735_PageTOC_APP_USER_DIR_QUERY_">
   </a>
   Return Value
  </h2>
  <p>
   Returns a string array containing all application user directories that match the query criteria. If no matching application user directories exist, a null scalar string is returned.
  </p>
  <h2 class="API">
   <a name="A_850317933_1011737">
   </a>
   <a name="A_850317933_1011737_PageTOC_APP_USER_DIR_QUERY_">
   </a>
   Arguments
  </h2>
  <h3 class="Argument">
   AuthorDirname
  </h3>
  <p>
   A string specifying the name of the
   <i>
    author directory
   </i>
   to be used by the calling application. For APP_USER_DIR_QUERY to work correctly,
   <i>
    AuthorDirname
   </i>
   must be set to the same value used in the call to APP_USER_DIR. See
   <a class="MCXref_Heading_0" href="APP_USER_DIR.html#A_850317933_1008659">
    APP_USER_DIR
   </a>
   for details.
  </p>
  <h3 class="Argument">
   AppDirname
  </h3>
  <p>
   A string specifying the name of the application directory to be used by the calling application. For APP_USER_DIR_QUERY to work correctly,
   <i>
    AppDirname
   </i>
   must be set to the same value used in the call to APP_USER_DIR. See
   <a class="MCXref_Heading_0" href="APP_USER_DIR.html#A_850317933_1008659">
    APP_USER_DIR
   </a>
   for details.
  </p>
  <h2 class="API">
   <a name="A_850317933_1011748">
   </a>
   <a name="A_850317933_1011748_PageTOC_APP_USER_DIR_QUERY_">
   </a>
   Keywords
  </h2>
  <h3 class="Keyword">
   <a name="A_850317933_1011749">
   </a>
   <a name="A_850317933_1011749_Keywords_APP_USER_DIR_QUERY_">
   </a>
   COUNT
  </h3>
  <p>
   Set this keyword equal to a named variable that will contain the number of matching application user directories found. If no matching directories are found, the specified variable will contain the value 0 (zero).
  </p>
  <h3 class="Keyword">
   <a name="A_850317933_1011751">
   </a>
   <a name="A_850317933_1011751_Keywords_APP_USER_DIR_QUERY_">
   </a>
   EXCLUDE_CURRENT
  </h3>
  <p>
   <span class="_Override" style="letter-spacing: -0.01em;">
    By default, APP_USER_DIR_QUERY includes the application user directory that matches the current system (the directory that would be returned by APP_USER_DIR
   </span>
   ) in
   <i>
    Result
   </i>
   . Set this keyword to exclude the directory returned by APP_USER_DIR from the
   <i>
    Result
   </i>
   .
  </p>
  <h2 class="API">
   <a name="A_850317933_1011753">
   </a>
   <a name="A_850317933_1011753_PageTOC_APP_USER_DIR_QUERY_">
   </a>
   RESTRICT Keywords
  </h2>
  <p>
   APP_USER_DIR_QUERY accepts the same RESTRICT keywords documented for
   <a class="MCXref_Heading_0" href="APP_USER_DIR.html#A_850317933_1008659">
    APP_USER_DIR
   </a>
   . For APP_USER_DIR_QUERY to work correctly, you must specify the same RESTRICT keywords as were specified to APP_USER_DIR. See the documentation for APP_USER_DIR for full details.
  </p>
  <p>
   There is a subtle difference in the meaning of the RESTRICT keywords between APP_USER_DIR and APP_USER_DIR_QUERY. In the case of APP_USER_DIR, specifying one of the RESTRICT keywords causes IDL to create a directory whose name incorporates information about the value of the specified attribute
   <i>
    on the current platform
   </i>
   . In the case of APP_USER_DIR_QUERY, specifying one of the RESTRICT keywords tells IDL that the directory name must contain information about the specified attribute; if the corresponding QUERY keyword is also specified, directory names that contain
   <i>
    any
   </i>
   value for the specified attribute will be matched.
  </p>
  <h2 class="API">
   <a name="A_850317933_1011759_PageTOC_APP_USER_DIR_QUERY_">
   </a>
   QUERY Keywords
  </h2>
  <p>
   A minimally correct call to APP_USER_DIR_QUERY consists of specifying the same
   <i>
    AuthorDirname
   </i>
   argument,
   <i>
    AppDirname
   </i>
   argument, and RESTRICT keywords as the corresponding call to APP_USER_DIR. Such a call will return a single string containing the path returned by APP_USER_DIR. Using APP_USER_DIR_QUERY in this manner is not particularly interesting; in order to locate
   <i>
    other
   </i>
   application user directories in addition to the one that applies to the current platform, you must add one or more QUERY keywords.
  </p>
  <p>
   Each QUERY keyword corresponds to one of the RESTRICT keywords. The presence of a QUERY keyword tells APP_USER_DIR_QUERY to search for application user directories that satisfy all of the RESTRICT keywords while allowing any value for the attribute specified by the QUERY keyword.
  </p>
  <h3>
   <a name="A_850317933_1011762">
   </a>
   <a name="A_850317933_1011762_Keywords_APP_USER_DIR_QUERY_">
   </a>
   QUERY_APPVERSION
  </h3>
  <p>
   Set this keyword to match application user directories that have any value for the application version. This keyword is quietly ignored if the RESTRICT_APPVERSION keyword is not set.
  </p>
  <h3>
   <a name="A_850317933_1011764">
   </a>
   <a name="A_850317933_1011764_Keywords_APP_USER_DIR_QUERY_">
   </a>
   QUERY_ARCH
  </h3>
  <p>
   Set this keyword to match application user directories that have any value for the hardware architecture. This keyword is quietly ignored if the RESTRICT_ARCH keyword is not set.
  </p>
  <h3>
   <a name="A_850317933_1011766">
   </a>
   <a name="A_850317933_1011766_Keywords_APP_USER_DIR_QUERY_">
   </a>
   QUERY_FAMILY
  </h3>
  <p>
   Set this keyword to match application user directories that have any value for the operating system family. This keyword is quietly ignored if the RESTRICT_FAMILY keyword is not set.
  </p>
  <h3>
   <a name="A_850317933_1011768">
   </a>
   <a name="A_850317933_1011768_Keywords_APP_USER_DIR_QUERY_">
   </a>
   QUERY_FILE_OFFSET_BITS
  </h3>
  <p>
   Set this keyword to match application user directories that have any value for the number of bits used for file offsets. This keyword is quietly ignored if the RESTRICT_FILE_OFFSET_BITS keyword is not set.
  </p>
  <h3>
   <a name="A_850317933_1011770">
   </a>
   <a name="A_850317933_1011770_Keywords_APP_USER_DIR_QUERY_">
   </a>
   QUERY_IDL_RELEASE
  </h3>
  <p>
   Set this keyword to match application user directories that have any value for the IDL version string. This keyword is quietly ignored if the RESTRICT_IDL_RELEASE keyword is not set.
  </p>
  <h3>
   <a name="A_850317933_1011772">
   </a>
   <a name="A_850317933_1011772_Keywords_APP_USER_DIR_QUERY_">
   </a>
   QUERY_MEMORY_BITS
  </h3>
  <p>
   Set this keyword to match application user directories that have any value for the number of bits used for memory addresses. This keyword is quietly ignored if the RESTRICT_MEMORY_BITS keyword is not set.
  </p>
  <h3>
   <a name="A_850317933_1011774">
   </a>
   <a name="A_850317933_1011774_Keywords_APP_USER_DIR_QUERY_">
   </a>
   QUERY_OS
  </h3>
  <p>
   Set this keyword to match application user directories that have any value for the operating system. This keyword is quietly ignored if the RESTRICT_OS keyword is not set.
  </p>
  <h2 class="API">
   <a name="A_850317933_1011776">
   </a>
   <a name="A_850317933_1011776_PageTOC_APP_USER_DIR_QUERY_">
   </a>
   Example
  </h2>
  <p>
   In the discussion of the APP_USER_DIR function, we give the example of an IDL application supporting the “Amazing” Grill System, a product of the fictional Acme Widgets, Inc. The application user directory created for that application is dependent on two attributes:
  </p>
  <table class="AutoNumber_p_Numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
   <col style="width: 16px;" />
   <col style="width: 24px;" />
   <col style="width: auto;" />
   <tr>
    <td valign="top">
    </td>
    <td class="AutoNumber_p_Numbered1" valign="top">
     <span>
      1.
     </span>
    </td>
    <td class="AutoNumber_p_Numbered1" madcap:autonum="1. " valign="top">
     Application version (RESTRICT_APPVERSION)
    </td>
   </tr>
  </table>
  <table class="AutoNumber_p_Numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
   <col style="width: 16px;" />
   <col style="width: 24px;" />
   <col style="width: auto;" />
   <tr>
    <td valign="top">
    </td>
    <td class="AutoNumber_p_Numbered1" valign="top">
     <span>
      2.
     </span>
    </td>
    <td class="AutoNumber_p_Numbered1" madcap:autonum="2. " valign="top">
     Operating system family (RESTRICT_FAMILY)
    </td>
   </tr>
  </table>
  <p>
   When a new version of IDL runs this application for the first time, the application code will find that its newly created application directory is empty. In such a situation, the application might wish to offer the user a choice between starting over with the application defaults or migrating settings and data from an older version of the application.
  </p>
  <p>
   The following call to APP_USER_DIR_QUERY can be used to locate application user directories that are for other versions of the application, but for the same operating system family. The QUERY_APPVERSION keyword causes the function to match all application versions, while the EXCLUDE_CURRENT keyword tells it to exclude the application user directory for the current system:
  </p>
  <p class="Code">
   old_appdirs = APP_USER_DIR_QUERY('acme', 'acme_grill', $
  </p>
  <p class="Code">
   &#160;&#160;&#160;RESTRICT_APPVERSION='1.0', /RESTRICT_FAMILY, $
  </p>
  <p class="Code">
   &#160;&#160;&#160;/QUERY_APPVERSION, /EXCLUDE_CURRENT)
  </p>
  <p>
   Note that APP_USER_DIR_QUERY may return more than one directory. It is up to the application to decide which one to use. Applications that intend to migrate information between versions should include information in their application user directories that will facilitate such migration.
  </p>
  <h2 class="API">
   <a name="A_850317933_1011786">
   </a>
   <a name="A_850317933_1011786_PageTOC_APP_USER_DIR_QUERY_">
   </a>
   Version History
  </h2>
  <table style="width: 499px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
   <col width="91px" />
   <col width="408px" />
   <tbody>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
      <p>
       6.1
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
      <p>
       Introduced
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <h2 class="API">
   <a name="A_850317933_1011788">
   </a>
   <a name="A_850317933_1011788_PageTOC_APP_USER_DIR_QUERY_">
   </a>
   See Also
  </h2>
  <p>
   <a class="MCXref_Heading_0" href="APP_USER_DIR.html#A_850317933_1008659">
    APP_USER_DIR
   </a>
   ,
   <a class="MCXref_Heading_0" href="../F/FILE_SEARCH.html#F_848155245_893545">
    FILE_SEARCH
   </a>
  </p>
  <p>
   &#160;
  </p>
  <p>
   &#160;
  </p>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>