<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="Routines (alphabetical)|Routines: W" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-US" xml:lang="en-US" madcap:pathtohelpsystem="../../../" madcap:helpsystemfilename="idl.xml" madcap:searchtype="Stem">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   WV_DWT
  </title>
  <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
  <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../idl_CSH.html#Reference Material/W/WV_DWT.html" style="">
    Open topic with navigation
   </a>
  </p>
  <div class="MCBreadcrumbsBox_0">
   <span class="MCBreadcrumbsPrefix">
    <![CDATA[ ]]>
   </span>
   <a class="MCBreadcrumbsLink" href="../../images/ref_part1.html">
    Routines (alphabetical)
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="W_list.html">
    Routines: W
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <span class="MCBreadcrumbs">
    WV_DWT
   </span>
  </div>
  <h1 class="Routine">
   <a name="ref_3320460235_1010303">
   </a>
   <a name="ref_3320460235_63367">
   </a>
   <a name="ref_3320460235_83545">
   </a>
   WV_DWT
  </h1>
  <p madcap:conditions="wavelet.Online_Help_Only">
   <madcap:conditionaltext madcap:conditions="wavelet.Online_Help_Only">
    <a class="MCXref_Heading_0" href="#ref_3320460235_1040051">
     Syntax
    </a>
    |
    <a class="MCXref_Heading_0" href="#ref_3320460235_1006167">
     Return Value
    </a>
    |
    <a class="MCXref_Heading_0" href="#ref_3320460235_1013757">
     Arguments
    </a>
    |
    <a class="MCXref_Heading_0" href="#ref_3320460235_1003131">
     Keywords
    </a>
    |
    <a class="MCXref_Heading_0" href="#ref_3320460235_1023190">
     Version History
    </a>
    |
    <a class="MCXref_Heading_0" href="#ref_3320460235_1011610">
     See Also
    </a>
   </madcap:conditionaltext>
  </p>
  <p>
   The
   <a name="kanchor2963">
   </a>
   WV_DWT function returns the multi-dimensional
   <a name="kanchor2964">
   </a>
   discrete
   <a name="kanchor2965">
   </a>
   wavelet transform of the input
   <span class="Italic">
    Array
   </span>
   . The transform is done by
   <a class="MCXref_Heading_0" href="WV_PWT.html#ref_3320460235_1003503">
    WV_PWT
   </a>
   using a user-inputted wavelet filter.
  </p>
  <p>
   The length of each dimension of
   <span class="Italic">
    Array
   </span>
   must be either a power of two (2), or must be less than four (4). The transform is not computed over dimensions of lengths less than four (4), but is computed over all other dimensions (for example, the wavelet transform of an array of size [3,&#160;256] is computed over each [1,&#160;256] column vector).
  </p>
  <p>
   WV_DWT is based on the routine
   <span class="Courier">
    wtn
   </span>
   described in section 13.10 of
   <span class="Italic">
    Numerical Recipes in C: The Art of Scientific Computing, 2nd ed.
   </span>
   (Cambridge University Press), and is used by permission.
  </p>
  <h2 class="API">
   <a name="ref_3320460235_1040051">
   </a>
   <a name="ref_3320460235_1003127_PageTOC_WV_DWT_">
   </a>
   Syntax
  </h2>
  <p class="Syntax">
   <span class="Italic">
    Result
   </span>
   = WV_DWT(
   <span class="Italic">
    Array
   </span>
   ,
   <span class="Italic">
    Scaling
   </span>
   ,
   <span class="Italic">
    Wavelet
   </span>
   ,
   <span class="Italic">
    Ioff
   </span>
   ,
   <span class="Italic">
    Joff
   </span>
   [,&#160;/
   <a class="MCXref_Heading_0" href="#ref_3320460235_1003349">
    DOUBLE
   </a>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#ref_3320460235_1003353">
    INVERSE
   </a>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#ref_3320460235_1043639">
    N_LEVELS
   </a>
   =
   <span class="Italic">
    value
   </span>
   ])
  </p>
  <h2 class="API">
   <a name="ref_3320460235_1006167">
   </a>
   <a name="ref_3320460235_1006167_PageTOC_WV_DWT_">
   </a>
   Return Value
  </h2>
  <p>
   The result is an output array of the same dimensions as
   <span class="Italic">
    Array
   </span>
   , containing the discrete wavelet transform over each dimension.
  </p>
  <h2 class="API">
   <a name="ref_3320460235_1013757">
   </a>
   <a name="ref_3320460235_1013757_PageTOC_WV_DWT_">
   </a>
   Arguments
  </h2>
  <h3 class="Argument">
   Array
  </h3>
  <p>
   The input vector or array. The length of each dimension must be either less than four (4) or a power of two (2).
  </p>
  <h3 class="Argument">
   Scaling
  </h3>
  <p>
   A vector of scaling (father) coefficients, of length N.
  </p>
  <h3 class="Argument">
   Wavelet
  </h3>
  <p>
   A vector of wavelet (mother) coefficients, of length N.
  </p>
  <h3 class="Argument">
   Ioff
  </h3>
  <p>
   An integer that specifies the support offset for
   <span class="Italic">
    Scaling
   </span>
   . To center the scaling function over each point in
   <span class="Italic">
    Array
   </span>
   , set
   <span class="Italic">
    Ioff
   </span>
   to –N/2+2.
  </p>
  <h3 class="Argument">
   Joff
  </h3>
  <p>
   An integer that specifies the support offset for
   <span class="Italic">
    Wavelet
   </span>
   . To center the wavelet function over each point in
   <span class="Italic">
    Array
   </span>
   , set
   <span class="Italic">
    Joff
   </span>
   to –N/2+2.
  </p>
  <h2 class="API">
   <a name="ref_3320460235_1003131">
   </a>
   <a name="ref_3320460235_1003131_PageTOC_WV_DWT_">
   </a>
   Keywords
  </h2>
  <h3 class="Keyword">
   <a name="ref_3320460235_1003349">
   </a>
   <a name="ref_3320460235_1003349_Keywords_WV_DWT_">
   </a>
   DOUBLE
  </h3>
  <p>
   Set this keyword to force the computation to be done in double-precision arithmetic.
  </p>
  <h3 class="Keyword">
   <a name="ref_3320460235_1003353">
   </a>
   <a name="ref_3320460235_1003353_Keywords_WV_DWT_">
   </a>
   INVERSE
  </h3>
  <p>
   If set, the inverse transform is computed. By default, the forward transform is computed.
  </p>
  <h3 class="Keyword">
   <a name="ref_3320460235_1043639">
   </a>
   <a name="ref_3320460235_23916">
   </a>
   N_LEVELS
  </h3>
  <p>
   Set this keyword to the number of wavelet levels to compute in the pyramid algorithm, starting with the smallest wavelet scale and progressing to larger scales. If this keyword is not set or is set to zero, then all wavelet levels in the pyramid algorithm are computed.
  </p>
  <h2 class="API">
   <a name="ref_3320460235_1011532_PageTOC_WV_DWT_">
   </a>
   Method and Result Format
  </h2>
  <p>
   The WV_DWT function computes the wavelet coefficients using the
   <a name="kanchor2966">
   </a>
   pyramidal algorithm (
   <a name="kanchor2967">
   </a>
   Mallat 1989).
  </p>
  <h3>
   <a name="ref_3320460235_1014172_Keywords_WV_DWT_">
   </a>
   One-Dimensional Vector
  </h3>
  <p>
   For a one-dimensional vector, the pyramid appears below:
  </p>
  <p class="Code">
   Array elements
  </p>
  <p class="Code">
   [&#160;0,&#160;&#160;1,&#160;&#160;2,&#160;&#160;3,&#160;&#160;4,&#160;&#160;5,&#160;&#160;6,&#160;&#160;7,&#160;&#160;8,&#160;&#160;9,&#160;10,&#160;11,&#160;12,&#160;13,&#160;14,&#160;15]
  </p>
  <p class="Code">
   &#160;&#160;&#160;\&#160;/&#160;&#160;&#160;&#160;&#160;\&#160;/&#160;&#160;&#160;&#160;&#160;\&#160;/&#160;&#160;&#160;&#160;&#160;\&#160;/&#160;&#160;&#160;&#160;&#160;\&#160;/&#160;&#160;&#160;&#160;&#160;\&#160;/&#160;&#160;&#160;&#160;&#160;\&#160;/&#160;&#160;&#160;&#160;&#160;\&#160;/
  </p>
  <p class="Code">
   &#160;&#160;s0,d0&#160;&#160;&#160;s1,d1&#160;&#160;&#160;s2,d2&#160;&#160;&#160;s3,d3&#160;&#160;&#160;s4,d4&#160;&#160;&#160;s5,d5&#160;&#160;&#160;s6,d6&#160;&#160;&#160;s7,d7
  </p>
  <p class="Code">
   &#160;&#160;&#160;&#160;&#160;\&#160;&#160;&#160;&#160;/&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;&#160;&#160;&#160;/&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;&#160;&#160;&#160;/&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;&#160;&#160;&#160;/
  </p>
  <p class="Code">
   &#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;/&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;/&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;/&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;/
  </p>
  <p class="Code">
   &#160;&#160;&#160;&#160;&#160;&#160;&#160;S0,D0&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;S1,D1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;S2,D2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;S3,D3
  </p>
  <p class="Code">
   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/
  </p>
  <p class="Code">
   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;&#160;&#160;&#160;&#160;/&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;&#160;&#160;&#160;&#160;/
  </p>
  <p class="Code">
   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;/&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;\&#160;/
  </p>
  <p class="Code">
   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
   <span class="Italic">
    &#160;&#160;
   </span>
   <span class="Helvetica_Bold">
    S
   </span>
   0,
   <span class="Helvetica_Bold">
    D
   </span>
   0&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
   <span class="Helvetica_Bold">
    S
   </span>
   1,
   <span class="Helvetica_Bold">
    D
   </span>
   1
  </p>
  <p>
   At each level of the hierarchy, the WV_PWT function is used to compute the scaling coefficient
   <span class="Courier">
    Si
   </span>
   and wavelet coefficient
   <span class="Courier">
    Di
   </span>
   (where
   <span class="Courier">
    i
   </span>
   represents the position). The letters
   <span class="Courier">
    s
   </span>
   ,
   <span class="Courier">
    S
   </span>
   ,
   <span class="Helvetica_Bold">
    S
   </span>
   and
   <span class="Courier">
    d
   </span>
   ,
   <span class="Courier">
    D
   </span>
   ,
   <span class="Helvetica_Bold">
    D
   </span>
   represent increasing scale. The wavelet coefficients are stored in
   <span class="Italic">
    Result
   </span>
   in order from largest scales to smallest:
  </p>
  <p class="Code">
   Result&#160;=&#160;[&#160;
   <span class="Helvetica_Bold">
    S
   </span>
   0,&#160;
   <span class="Helvetica_Bold">
    S
   </span>
   1,&#160;&#160;
   <span class="Helvetica_Bold">
    D
   </span>
   0,&#160;
   <span class="Helvetica_Bold">
    D
   </span>
   1,&#160;&#160;D0,&#160;D1,&#160;D2,&#160;D3,
  </p>
  <p class="Code">
   &#160;&#160;d0,&#160;d1,&#160;d2,&#160;d3,&#160;d4,&#160;d5,&#160;d6,&#160;d7&#160;]
  </p>
  <h3>
   <a name="ref_3320460235_1013777_Keywords_WV_DWT_">
   </a>
   Two-Dimensional Array
  </h3>
  <p>
   For a two-dimensional Array, the wavelet transform is computed using the pyramidal algorithm along each dimension. The wavelet coefficients are stored in order with the largest scales in the [0, 0] position. As an example, for an 8&#160;x&#160;8
   <span class="Italic">
    Array
   </span>
   , the
   <span class="Italic">
    Result
   </span>
   is an 8&#160;x&#160;8 array with the following structure:
  </p>
  <p class="Code">
   [0,0]
  </p>
  <p class="Code">
   &#160;[[&#160;A0B0&#160;&#160;A1B0&#160;&#160;&#160;&#160;C0B0&#160;&#160;C1B0&#160;&#160;&#160;&#160;c0B0&#160;&#160;c1B0&#160;&#160;c2B0&#160;&#160;c3B0&#160;],
  </p>
  <p class="Code">
   &#160;&#160;[&#160;A0B1&#160;&#160;A1B1&#160;&#160;&#160;&#160;C0B1&#160;&#160;C1B1&#160;&#160;&#160;&#160;c0B1&#160;&#160;c1B1&#160;&#160;c2B1&#160;&#160;c3B1&#160;],
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   &#160;&#160;[&#160;A0D0&#160;&#160;A1D0&#160;&#160;&#160;&#160;C0D0&#160;&#160;C1D0&#160;&#160;&#160;&#160;c0D0&#160;&#160;c1D0&#160;&#160;c2D0&#160;&#160;c3D0&#160;],
  </p>
  <p class="Code">
   &#160;&#160;[&#160;A0D1&#160;&#160;A1D1&#160;&#160;&#160;&#160;C0D1&#160;&#160;C1D1&#160;&#160;&#160;&#160;c0D1&#160;&#160;c1D1&#160;&#160;c2D1&#160;&#160;c3D1&#160;],
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   &#160;&#160;[&#160;A0d0&#160;&#160;A1d0&#160;&#160;&#160;&#160;C0d0&#160;&#160;C1d0&#160;&#160;&#160;&#160;c0d0&#160;&#160;c1d0&#160;&#160;c2d0&#160;&#160;c3d0&#160;],
  </p>
  <p class="Code">
   &#160;&#160;[&#160;A0d1&#160;&#160;A1d1&#160;&#160;&#160;&#160;C0d1&#160;&#160;C1d1&#160;&#160;&#160;&#160;c0d1&#160;&#160;c1d1&#160;&#160;c2d1&#160;&#160;c3d1&#160;],
  </p>
  <p class="Code">
   &#160;&#160;[&#160;A0d2&#160;&#160;A1d2&#160;&#160;&#160;&#160;C0d2&#160;&#160;C1d2&#160;&#160;&#160;&#160;c0d2&#160;&#160;c1d2&#160;&#160;c2d2&#160;&#160;c3d2&#160;],
  </p>
  <p class="Code">
   &#160;&#160;[&#160;A0d3&#160;&#160;A1d3&#160;&#160;&#160;&#160;C0d3&#160;&#160;C1d3&#160;&#160;&#160;&#160;c0d3&#160;&#160;c1d3&#160;&#160;c2d3&#160;&#160;c3d3&#160;]]
  </p>
  <p>
   Here
   <span class="Courier">
    A
   </span>
   and
   <span class="Courier">
    B
   </span>
   represent the scale coefficients for the first and second dimensions, respectively, The
   <span class="Courier">
    C
   </span>
   and
   <span class="Courier">
    D
   </span>
   represent the largest-scale wavelet coefficients for the first and second dimensions, respectively, while
   <span class="Courier">
    c
   </span>
   and
   <span class="Courier">
    d
   </span>
   represent the small-scale wavelet coefficients. Subscripts
   <span class="Courier">
    0
   </span>
   ,
   <span class="Courier">
    1
   </span>
   ,
   <span class="Courier">
    2
   </span>
   ,
   <span class="Courier">
    3
   </span>
   denote the position of the wavelet within the image.
  </p>
  <h2 class="API">
   Example
  </h2>
  <p>
   The following example shows how to compute the first three levels of the pyramid algorithm using either the N_LEVELS keyword or WV_PWT:
  </p>
  <p>
   &#160;
  </p>
  <p class="Code">
   ; Construct a random vector.
  </p>
  <p class="Code">
   n = 1024
  </p>
  <p class="Code">
   x = randomn(s,n)
  </p>
  <p class="Code">
   info = WV_FN_DAUBECHIES(2, wavelet, scaling, ioff, joff)
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Take the wavelet transform but stop at level 3.
  </p>
  <p class="Code">
   wv_dwtpartial = WV_DWT(x, wavelet, scaling, ioff, joff, $
  </p>
  <p class="Code">
   &#160;&#160;&#160;N_LEVELS=3)
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; First level of the pyramid algorithm.
  </p>
  <p class="Code">
   wv_level1 = WV_PWT(x, wavelet, scaling, ioff, joff)
  </p>
  <p class="Code">
   w_scaling1 = wv_level1[0:n/2-1]  ; Left (scaling) half
  </p>
  <p class="Code">
   w_wavelet1 = wv_level1[n/2:*]    ; Right (wavelet) half
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Second level of the pyramid algorithm.
  </p>
  <p class="Code">
   wv_level2 = WV_PWT(w_scaling1, wavelet, scaling, ioff, joff)
  </p>
  <p class="Code">
   w_scaling2 = wv_level2[0:n/4-1]  ; Left (scaling) half
  </p>
  <p class="Code">
   w_wavelet2 = wv_level2[n/4:*]    ; Right (wavelet) half
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Third level of the pyramid algorithm.
  </p>
  <p class="Code">
   wv_level3 = WV_PWT(w_scaling2, wavelet, scaling, ioff, joff)
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Verify that using WV_DWT with N_LEVELS=3
  </p>
  <p class="Code">
   ; is the same as calling WV_PWT three times.
  </p>
  <p class="Code">
   wv_partial123 = [wv_level3, w_wavelet2, w_wavelet1]
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   print, MAX(ABS(wv_dwtpartial - wv_partial123))
  </p>
  <p>
   IDL prints:
  </p>
  <p class="Code">
   0.000000
  </p>
  <h2 class="API">
   <a name="ref_3320460235_1023190">
   </a>
   <a name="ref_3320460235_1023190_PageTOC_WV_DWT_">
   </a>
   Version History
  </h2>
  <p>
   &#160;
  </p>
  <table cellpadding="0" cellspacing="0" class="Default" height="56px" style="border-spacing-x: 0;border-spacing-y: 0;border-collapse: collapse;border-color: black;width: 499px;caption-side: top;">
   <col width="91px" />
   <col width="408px" />
   <tbody>
    <tr style="height: 13px;">
     <td>
      <p>
       5.3
      </p>
     </td>
     <td>
      <p>
       Introduced
      </p>
     </td>
    </tr>
    <tr style="height: 13px;">
     <td>
      <p>
       6.1
      </p>
     </td>
     <td>
      <p>
       Added N_LEVELS keyword
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <h2 class="API">
   <a name="ref_3320460235_1011610">
   </a>
   <a name="ref_3320460235_1011610_PageTOC_WV_DWT_">
   </a>
   See Also
  </h2>
  <p>
   <a class="MCXref_Heading_0" href="WV_CWT.html#ref_3320460235_1009330" target="" title="" alt="">
    WV_CWT
   </a>
   ,
   <a class="MCXref_Heading_0" href="WV_PWT.html#ref_3320460235_1003503" target="" title="" alt="">
    WV_PWT
   </a>
   ,
   <a class="MCXref_Heading_0" href="WTN.html" target="" title="" alt="">
    WTN
   </a>
  </p>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>