<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="Routines (alphabetical)|Routines: C" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-US" xml:lang="en-US" madcap:pathtohelpsystem="../../../" madcap:helpsystemfilename="idl.xml" madcap:searchtype="Stem">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   CPU
  </title>
  <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
  <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
  <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../idl_CSH.html#Reference Material/C/CPU.html" style="">
    Open topic with navigation
   </a>
  </p>
  <div class="MCBreadcrumbsBox_0">
   <span class="MCBreadcrumbsPrefix">
    <![CDATA[ ]]>
   </span>
   <a class="MCBreadcrumbsLink" href="../../images/ref_part1.html">
    Routines (alphabetical)
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="C_list.html">
    Routines: C
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <span class="MCBreadcrumbs">
    CPU
   </span>
  </div>
  <h1 class="Routine">
   <a name="C_854643309_1032355">
   </a>
   <a name="C_854643309_37267">
   </a>
   CPU
  </h1>
  <p madcap:conditions="Reference Material.Online_Help_Only">
   <madcap:conditionaltext madcap:conditions="Reference Material.Online_Help_Only">
    <a class="MCXref_Heading_0" href="#C_854643309_1032359">
     Syntax
    </a>
    |
    <a class="MCXref_Heading_0" href="#C_854643309_1075642">
     Arguments
    </a>
    |
    <a class="MCXref_Heading_0" href="#C_854643309_1032361">
     Keywords
    </a>
    |
    <a class="MCXref_Heading_0" href="#C_854643309_1032405">
     Example
    </a>
    |
    <a class="MCXref_Heading_0" href="#C_854643309_1042365">
     Version History
    </a>
    |
    <a class="MCXref_Heading_0" href="#C_854643309_1052234">
     See Also
    </a>
   </madcap:conditionaltext>
  </p>
  <p>
   The
   <a name="kanchor395">
   </a>
   CPU procedure is used to change the values stored in the read-only !CPU system variable, which in turn controls the way IDL uses the system processor or processors.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   Not all routines are affected by changes to the !CPU system variable. Those routines that
   <i>
    are
   </i>
   affected can override some of the values in the !CPU system variable by setting
   <i>
    thread pool keywords
   </i>
   , which change the way IDL uses the system processor(s) during a single invocation of the routine. A list of thread pool keywords appears at the end of the keywords list for each routine that is affected by the state of the !CPU system variable.
  </p>
  <h2 class="API">
   <a name="C_854643309_1032359">
   </a>
   <a name="C_854643309_1032359_PageTOC_CPU_">
   </a>
   Syntax
  </h2>
  <p class="Syntax">
   CPU [,&#160;/
   <a class="MCXref_Heading_0" href="#C_854643309_1178606">
    RESET
   </a>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#C_854643309_1178609">
    RESTORE
   </a>
   &#160;=&#160;
   <i>
    structure
   </i>
   ] [,
   <a class="MCXref_Heading_0" href="#C_854643309_1032362">
    TPOOL_MAX_ELTS
   </a>
   &#160;=&#160;
   <i>
    NumMaxElts
   </i>
   ] [,
   <a class="MCXref_Heading_0" href="#C_854643309_1032364">
    TPOOL_MIN_ELTS
   </a>
   &#160;=&#160;
   <i>
    NumMinElts
   </i>
   ] [,
   <a class="MCXref_Heading_0" href="#C_854643309_1032366">
    TPOOL_NTHREADS
   </a>
   &#160;=&#160;
   <i>
    NumThreads
   </i>
   ] [,/
   <a class="MCXref_Heading_0" href="#C_854643309_1032368">
    VECTOR_ENABLE
   </a>
   ]
  </p>
  <h2 class="API">
   <a name="C_854643309_1075642">
   </a>
   <a name="C_854643309_22553">
   </a>
   Arguments
  </h2>
  <p>
   None.
  </p>
  <h2 class="API">
   <a name="C_854643309_1032361">
   </a>
   <a name="C_854643309_1032361_PageTOC_CPU_">
   </a>
   Keywords
  </h2>
  <h3 class="Keyword">
   <a name="C_854643309_1178606">
   </a>
   <a name="C_854643309_1178606_Keywords_CPU_">
   </a>
   RESET
  </h3>
  <p>
   Set this keyword to cause the CPU procedure to reset the values contained in the !CPU system variable to the values it had when IDL was started. The RESET and RESTORE keywords are mutually exclusive; only one of them can be specified in a given call to CPU.
  </p>
  <h3 class="Keyword">
   <a name="C_854643309_1178609">
   </a>
   <a name="C_854643309_1178609_Keywords_CPU_">
   </a>
   RESTORE
  </h3>
  <p>
   Set this keyword equal to a structure of type !CPU to set the !CPU system variable with the values contained in the structure.  The RESET and RESTORE keywords are mutually exclusive; only one of them can be specified in a given call to CPU.
  </p>
  <h3 class="Keyword">
   <a name="C_854643309_1032362">
   </a>
   <a name="C_854643309_1032362_Keywords_CPU__">
   </a>
   TPOOL_MAX_ELTS
  </h3>
  <p>
   This keyword changes the value returned by !CPU.TPOOL_MAX_ELTS.
  </p>
  <p>
   Set this keyword to a non-zero value to set the maximum number of data elements involved in a computation that uses the thread pool. If the number of elements in the computation exceeds the number contained in !CPU.TPOOL_MAX_ELTS, IDL will not use the thread pool for the computation. Setting this value to 0 removes any limit on maximum number of elements, and any computation with at least !CPU.TPOOL_MIN_ELTS will use the thread pool.
  </p>
  <h3 class="Keyword">
   <a name="C_854643309_1032364">
   </a>
   <a name="C_854643309_1032364_Keywords_CPU__">
   </a>
   TPOOL_MIN_ELTS
  </h3>
  <p>
   This keyword changes the value returned by !CPU.TPOOL_MIN_ELTS.
  </p>
  <p>
   Set this keyword to a non-zero value to set the minimum number of data elements involved in a computation that uses the thread pool. If the number of elements in the computation is less than the number contained in !CPU.TPOOL_MIN_ELTS, IDL will not use the thread pool for the computation. Use this keyword to prevent IDL from using the thread pool on tasks that are too small to benefit from it.
  </p>
  <h3 class="Keyword">
   <a name="C_854643309_1032366">
   </a>
   <a name="C_854643309_1032366_Keywords_CPU__">
   </a>
   TPOOL_NTHREADS
  </h3>
  <p>
   This keyword changes the value returned by !CPU.TPOOL_NTHREADS.
  </p>
  <p>
   Set this keyword to the number of threads IDL should use when performing computations that take advantage of the thread pool. By default, IDL will use !CPU.HW_NCPU threads, so that each thread will have the potential to run in parallel with the others. Set this keyword equal to 0 (zero) to ensure that !CPU.HW_NCPU threads will be used. Set this keyword equal to 1 (one) to disable use of the thread pool.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   For numerical computation, there is no benefit to using more threads than your system has CPUs. However, depending on the size of the problem and the number of other programs running on the system, there may be a performance advantage to using
   <i>
    fewer
   </i>
   CPUs.
  </p>
  <p>
   !CPU.TPOOL_NTHREADS is initialized with the value of the IDL_CPU_TPOOL_NTHREADS preference at startup. On systems shared by multiple users, you may wish to set this preference so that IDL uses the specified number of threads instead of defaulting to the number of CPUs present in the underlying hardware.
  </p>
  <h3 class="Keyword">
   <a name="C_854643309_1032368">
   </a>
   <a name="C_854643309_1032368_Keywords_CPU__">
   </a>
   VECTOR_ENABLE
  </h3>
  <p>
   This keyword changes the value returned by !CPU.VECTOR_ENABLE.
  </p>
  <p>
   Set this keyword to enable use of the system’s vector unit (e.g. Macintosh Altivec/Velocity Engine) if one is present. Set this keyword equal to 0 (zero) explicitly disable such use. This keyword is ignored if the current system does not support a vector unit (that is, if !CPU.HW_VECTOR =0).
  </p>
  <h2 class="API">
   <a name="C_854643309_1178861">
   </a>
   <a name="C_854643309_71715">
   </a>
   Restoring !CPU Values
  </h2>
  <p>
   It is sometimes necessary to alter the way IDL uses the system processor or processors for a section of code, and then to restore IDL to the settings in effect before the code section was executed. It is often possible to accomplish this using the thread pool keywords to specific routines; in some circumstances, however, this approach may be inconvenient or ineffective. For example:
  </p>
  <p class="Bullet">
   If the section of code includes many routines for which alterations are required, the repetition of the keywords is inconvenient and error prone.
  </p>
  <p class="Bullet">
   Binary and unary operators that use the thread pool do not accept keywords.
  </p>
  <p class="Bullet">
   There is no keyword equivalent to the !CPU.VECTOR_ENABLE field.
  </p>
  <p class="Bullet">
   Future versions of IDL may provide additional CPU options; adding keywords to your code to invoke these options could pose maintenance problems.
  </p>
  <p class="Bullet">
   You may be working with IDL routines you did not write.
  </p>
  <p>
   In all of these cases, the answer is to use the CPU procedure to alter the value of the !CPU system variable to suit the needs of your code, execute the code, and then reset !CPU to the state it had initially. It is possible to do this by using the individual keywords to CPU, as shown below:
  </p>
  <p class="Code">
   save_cpu = !CPU               ; Save the current configuration
  </p>
  <p class="Code">
   CPU, TPOOL_NTHREADS=2, ...    ; Change the current configuration
  </p>
  <p class="Code">
   ...                           ; Carry out a computation
  </p>
  <p class="Code">
   ; Restore the CPU state
  </p>
  <p class="Code">
   CPU, TPOOL_MAX_ELTS=save_cpu.tpool_max_elts, $
  </p>
  <p class="Code">
   &#160;&#160;&#160;TPOOL_MIN_ELTS=save_cpu.tpool_min_elts, $
  </p>
  <p class="Code">
   &#160;&#160;&#160;TPOOL_NTHREADS=save_cpu.tpool_nthreads
  </p>
  <p>
   There are two obvious problems with this approach: it is tedious and error prone, and if new versions of IDL add new CPU attributes, your code will require updates in order to reset them.
  </p>
  <p>
   The RESTORE keyword to CPU solves both of these problems. When a structure of type !CPU is supplied using the RESTORE keyword, IDL adjusts the !CPU system variable to match the structure. Using RESTORE, the above example becomes:
  </p>
  <p class="Code">
   save_cpu = !CPU
  </p>
  <p class="Code">
   CPU, TPOOL_NTHREADS=2, ...
  </p>
  <p class="Code">
   ...
  </p>
  <p class="Code">
   CPU, RESTORE=save_cpu
  </p>
  <p>
   The RESET keyword is similar to RESTORE, but it resets the !CPU system variable to the values it had when IDL first started. The syntax is:
  </p>
  <p class="Code">
   CPU, /RESET
  </p>
  <p>
   The RESET keyword is useful in
   <i>
    ad hoc
   </i>
   analysis, when you’ve made changes to the !CPU system variable manually (perhaps as an experiment), and you wish to bring !CPU back to its default state for your machine without exiting and restarting IDL.
  </p>
  <p>
   RESET and RESTORE are mutually exclusive — only one of them can be used in a given call to the CPU procedure. However, they are allowed in conjunction with the other keywords to CPU. In such cases, the explicit keywords take precedence over the values from the RESET or RESTORE keywords. For example, the following statement changes the number of threads used by the IDL thread pool to 3, and sets all other CPU parameters to the values contained in a variable named
   <span class="Courier">
    save_cpu
   </span>
   :
  </p>
  <p class="Code">
   CPU, TPOOL_NTHREADS=3, RESTORE=save_cpu
  </p>
  <h2 class="API">
   <a name="C_854643309_1032405">
   </a>
   <a name="C_854643309_1032405_PageTOC_CPU_">
   </a>
   Example
  </h2>
  <p>
   Configure !CPU so that by default, IDL will use two threads for computations that involve more than 5000 data values.
  </p>
  <p class="Code">
   CPU, TPOOL_MIN_ELTS=5000, TPOOL_NTHREADS=2
  </p>
  <h2 class="API">
   <a name="C_854643309_1042365">
   </a>
   <a name="C_854643309_1042365_PageTOC_CPU_">
   </a>
   Version History
  </h2>
  <table style="width: 499px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
   <col width="91px" />
   <col width="408px" />
   <tbody>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_ColSep">
      <p>
       5.5
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_ColEnd">
      <p>
       Introduced
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
      <p>
       6.1
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
      <p>
       Added RESET and RESTORE keywords
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <h2 class="API">
   <a name="C_854643309_1052234">
   </a>
   <a name="C_854643309_1052234_PageTOC_CPU_">
   </a>
   See Also
  </h2>
  <p>
   <a class="MCXref_Heading_0" href="../../Creating IDL Programs/Appendices/IDL_Environment_System_V.html#sysvars_272074529_1014201">
    !CPU
   </a>
  </p>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>