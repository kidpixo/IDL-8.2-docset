<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="Routines (alphabetical)|Routines: C" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-US" xml:lang="en-US" madcap:pathtohelpsystem="../../../" madcap:helpsystemfilename="idl.xml" madcap:searchtype="Stem">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   CONVOL
  </title>
  <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../Resources/TableStyles/Description.css" rel="stylesheet" />
  <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
  <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
  <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../idl_CSH.html#Reference Material/C/CONVOL.html" style="">
    Open topic with navigation
   </a>
  </p>
  <div class="MCBreadcrumbsBox_0">
   <span class="MCBreadcrumbsPrefix">
    <![CDATA[ ]]>
   </span>
   <a class="MCBreadcrumbsLink" href="../../images/ref_part1.html">
    Routines (alphabetical)
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="C_list.html">
    Routines: C
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <span class="MCBreadcrumbs">
    CONVOL
   </span>
  </div>
  <h1 class="Routine">
   <a name="C_854643309_676395">
   </a>
   <a name="C_854643309_17663">
   </a>
   CONVOL
  </h1>
  <p madcap:conditions="Reference Material.Online_Help_Only">
   <madcap:conditionaltext madcap:conditions="Reference Material.Online_Help_Only">
    <a class="MCXref_Heading_0" href="#C_854643309_1298073">
     Syntax
    </a>
    |
    <a class="MCXref_Heading_0" href="#C_854643309_1075476">
     Return Value
    </a>
    |
    <a class="MCXref_Heading_0" href="#C_854643309_676400">
     Arguments
    </a>
    |
    <a class="MCXref_Heading_0" href="#C_854643309_676408">
     Keywords
    </a>
    |
    <a class="MCXref_Heading_0" href="#C_854643309_1297673">
     Additional Examples
    </a>
    |
    <a class="MCXref_Heading_0" href="#C_854643309_1297681">
     Version History
    </a>
    |
    <a class="MCXref_Heading_0" href="#C_854643309_1052213">
     See Also
    </a>
   </madcap:conditionaltext>
  </p>
  <p>
   The
   <a name="kanchor375">
   </a>
   CONVOL function
   <a name="kanchor376">
   </a>
   convolves an array with a
   <a name="kanchor377">
   </a>
   kernel, and returns the result. Convolution is a general process that can be used for various types of
   <a name="kanchor378">
   </a>
   smoothing,
   <a name="kanchor379">
   </a>
   signal processing, shifting,
   <a name="kanchor380">
   </a>
   differentiation,
   <a name="kanchor381">
   </a>
   edge detection, etc. The CENTER keyword controls the alignment of the kernel with the array and the ordering of the kernel elements. If CENTER is explicitly set to 0, convolution is performed in the strict mathematical sense; otherwise, the kernel is centered over each data point.
  </p>
  <h2 class="API">
   Example
   <img src="../../images/convol_example1.gif" class="ImgFloatRight" />
  </h2>
  <p>
   This example uses a kernel to detect diagonal lines in an image.
  </p>
  <p class="Code">
   ; Sample image
  </p>
  <p class="Code">
   array = FIX(READ_PNG(FILEPATH('mineral.png', $
  </p>
  <p class="Code">
   &#160;&#160;SUBDIRECTORY=['examples','data'])))
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Edge detection kernel
  </p>
  <p class="Code">
   kernel = [ [0,1,0],[-1,0,1],[0,-1,0] ]
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   result = CONVOL(array, kernel)
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   im1 = IMAGE(array, LAYOUT=[2,1,1], RGB_TABLE=39)
  </p>
  <p class="Code">
   im2 = IMAGE(result, LAYOUT=[2,1,2], /CURRENT)
  </p>
  <h3>
   Additional Examples
  </h3>
  <p>
   See
   <a href="#C_854643309_1297673" target="" title="" alt="" class="MCXref_0">
    Additional Examples
   </a>
   for more code examples using the CONVOL function.
  </p>
  <h3>
   Using CONVOL
  </h3>
  <p>
   Assume R = CONVOL(A, K, S), where
   <i>
    A
   </i>
   is an
   <i>
    n
   </i>
   -element vector,
   <i>
    K
   </i>
   is an
   <i>
    k
   </i>
   -element
   <span class="_Override" style="letter-spacing: -0.01em;">
    vector (
   </span>
   <i style="letter-spacing: 0em;">
    k
   </i>
   ≤
   <i style="letter-spacing: 0em;">
    n
   </i>
   <span class="_Override" style="letter-spacing: -0.01em;">
    ), and
   </span>
   <i style="letter-spacing: 0em;">
    S
   </i>
   <span class="_Override" style="letter-spacing: -0.01em;">
    is the scale factor. If the CENTER keyword is omitted or set to
   </span>
   1:
  </p>
  <p>
   <img src="../../images/9_9.jpg" />
  </p>
  <p>
   where the value
   <i>
    k
   </i>
   /2 is determined by
   <i>
    integer division
   </i>
   . This means that the result of the division is the largest
   <i>
    integer
   </i>
   value less than or equal to the fractional number.
  </p>
  <p>
   If CENTER is explicitly set to 0:
  </p>
  <p>
   <img src="../../images/9_10.jpg" />
  </p>
  <p>
   In the two-dimensional, zero CENTER case where
   <i>
    A
   </i>
   is an
   <i>
    m
   </i>
   -by-
   <i>
    n
   </i>
   -element array, and
   <i>
    K
   </i>
   is the
   <i>
    k
   </i>
   -by-
   <i>
    k
   </i>
   element kernel; the result
   <i>
    R
   </i>
   is an
   <i>
    m
   </i>
   by
   <i>
    n
   </i>
   -element array:
  </p>
  <p>
   <img src="../../images/9_11.jpg" />
  </p>
  <p>
   The centered case is similar, except the
   <i>
    t-i
   </i>
   and
   <i>
    u-j
   </i>
   subscripts are replaced by
   <i>
    t+i-k
   </i>
   /2 and
   <i>
    u+j-k
   </i>
   /2.
  </p>
  <h2 class="API">
   <a name="C_854643309_1298073">
   </a>
   <a name="C_854643309_997070_PageTOC_CONVOL_">
   </a>
   Syntax
  </h2>
  <p class="Syntax">
   <i>
    Result
   </i>
   = CONVOL(
   <i>
    Array
   </i>
   ,
   <i>
    Kernel
   </i>
   [,&#160;
   <i>
    Scale_Factor
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#C_854643309_1297165">
    BIAS
   </a>
   =
   <span class="_Override" style="font-style: italic;">
    value
   </span>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#C_854643309_676409">
    CENTER
   </a>
   ] [, /
   <a href="#EDGE_MIR" target="" title="" alt="" class="MCXref_0">
    EDGE_MIRROR
   </a>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#C_854643309_746326">
    EDGE_TRUNCATE
   </a>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#C_854643309_1298048">
    EDGE_WRAP
   </a>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#C_854643309_1297184">
    EDGE_ZERO
   </a>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#C_854643309_1297467">
    INVALID
   </a>
   =
   <span class="_Override" style="font-style: italic;">
    value
   </span>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#C_854643309_1028668">
    MISSING
   </a>
   =
   <i>
    value
   </i>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#C_854643309_1028683">
    NAN
   </a>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#C_854643309_1297207">
    NORMALIZE
   </a>
   ] )
  </p>
  <h2 class="API">
   <a name="C_854643309_1075476">
   </a>
   <a name="C_854643309_98790">
   </a>
   Return Value
  </h2>
  <p>
   Returns the result of the array convolution. Depending on
   <span class="_Override" style="font-style: italic;">
    Array
   </span>
   ’s type, the computation might be performed using a different type, although the result will always have the same type as
   <span class="_Override" style="font-style: italic;">
    Array
   </span>
   . The following table shows the types used, as well as any clipping of the result values. The calculation type is also used for
   <span class="_Override" style="font-style: italic;">
    Kernel
   </span>
   ,
   <span class="_Override" style="font-style: italic;">
    Scale_Factor
   </span>
   , and
   <a class="MCXref_Heading_0" href="#C_854643309_1297165">
    BIAS
   </a>
   .
  </p>
  <table style="width: 384px;caption-side: bottom;mc-table-style: url('../../Resources/TableStyles/Description.css');" cellspacing="0" class="TableStyle_Description">
   <caption valign="bottom" style="padding-bottom: 12pt;">
   </caption>
   <p class="TableTitle">
    <a name="C_854643309_1297125">
    </a>
    <a name="C_854643309_51329">
    </a>
    Calculation Types and Clipping for CONVOL’s Return Value
   </p>
   <col width="96px" />
   <col width="144px" />
   <col width="144px" />
   <thead>
    <tr>
     <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
      <p>
       Array Type
      </p>
     </td>
     <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
      <p>
       Kernal and Calculation Type
      </p>
     </td>
     <td class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
      <p>
       Clipping
      </p>
     </td>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       BYTE
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       LONG
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       [0,255]
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       INT
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       LONG
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       [-32768,32767]
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       LONG
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       LONG
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       None
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       FLOAT
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       FLOAT
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       None
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       DOUBLE
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       DOUBLE
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       None
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       COMPLEX
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       COMPLEX
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       None
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       DCOMPLEX
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       DCOMPLEX
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       None
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       UINT
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       LONG
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       [0,65535]
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       ULONG
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       LONG
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       None
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       LONG64
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       LONG64
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       None
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
      <p>
       ULONG64
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
      <p>
       LONG64
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowEnd_ColEnd">
      <p>
       None
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <h2 class="API">
   <a name="C_854643309_676400">
   </a>
   <a name="C_854643309_676400_PageTOC_CONVOL_">
   </a>
   Arguments
  </h2>
  <h3 class="Argument">
   Array
  </h3>
  <p>
   An array of any basic type except string. The result of CONVOL has the same type and dimensions as
   <i>
    Array
   </i>
   .
  </p>
  <h3 class="Argument">
   Kernel
  </h3>
  <p>
   An array of any type except string. If the type of
   <i>
    Kernel
   </i>
   is not the same as
   <i>
    Array
   </i>
   , a copy of
   <i>
    Kernel
   </i>
   is made and converted to the appropriate type before use (for byte data, the kernel is converted to type LONG). The size of the kernel dimensions must be less than or equal to those of
   <i>
    Array
   </i>
   . CONVOL accepts non-square kernels including one-dimensional kernels.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   According to the mathematical definition of convolution, the kernel should be reversed before performing the computation. Since IDL does not reverse the kernel, it is actually computing the
   <i>
    correlation
   </i>
   rather than the
   <i>
    convolution
   </i>
   . For symmetric kernels this distinction is irrelevant. For asymmetric kernels, use
   <a class="MCXref_Heading_0" href="../R/REVERSE.html#R_822202989_758865">
    REVERSE
   </a>
   to change the order of the kernel argument if you want to produce the convolution.
  </p>
  <h3 class="Argument">
   Scale_Factor
  </h3>
  <p>
   A scale factor that is divided into each resulting value. This argument should be of the same type as the calculation type in
   <a class="MCXref_Table_Reference_0" href="#C_854643309_1297125">
    Table
   </a>
   , and is automatically converted if necessary. For byte or integer input arrays, the argument allows the use of fractional kernel values and avoids overflow of the result. If omitted or set to zero, a scale factor of 1 is used.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   The same
   <span class="_Override" style="font-style: italic;">
    Scale_Factor
   </span>
   is always divided into each result value, regardless of any missing data as specified by the
   <a class="MCXref_Heading_0" href="#C_854643309_1297467">
    INVALID
   </a>
   or
   <a class="MCXref_Heading_0" href="#C_854643309_1028683">
    NAN
   </a>
   keywords. It is usually not appropriate to divide the result value by the full scale factor if portions of the kernel were not applied due to missing data. In this case, you might want to use the
   <a class="MCXref_Heading_0" href="#C_854643309_1297207">
    NORMALIZE
   </a>
   keyword instead.
  </p>
  <h2 class="API">
   <a name="C_854643309_676408">
   </a>
   <a name="C_854643309_676408_PageTOC_CONVOL_">
   </a>
   Keywords
  </h2>
  <h3 class="Keyword">
   <a name="C_854643309_1297165">
   </a>
   <a name="C_854643309_75137">
   </a>
   BIAS
  </h3>
  <p>
   Set this keyword to the bias offset to be added to each result value, after any
   <span class="_Override" style="font-style: italic;">
    Scale_Factor
   </span>
   has been applied. BIAS should be of the same type as the calculation type inthe previous table, and will be automatically converted if necessary. If you have negative kernel values and a byte or unsigned integer input array, you can use this keyword to ensure that the result values are within the range of your data type.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   The same BIAS is always added to each result value, regardless of any missing data as specified by the
   <a class="MCXref_Heading_0" href="#C_854643309_1297467">
    INVALID
   </a>
   or
   <a class="MCXref_Heading_0" href="#C_854643309_1028683">
    NAN
   </a>
   keywords. It is usually not appropriate to add the full BIAS if portions of the kernel were not applied due to missing data. In this case, you might want to use the
   <a class="MCXref_Heading_0" href="#C_854643309_1297207">
    NORMALIZE
   </a>
   keyword instead.
  </p>
  <h3 class="Keyword">
   <a name="C_854643309_676409">
   </a>
   <a name="C_854643309_676409_Keywords_CONVOL__">
   </a>
   CENTER
  </h3>
  <p>
   Set or omit this keyword to center the kernel over each array point. If CENTER is explicitly set to zero, the CONVOL function works in the conventional mathematical sense. In many signal and image processing applications, it is useful to center a symmetric kernel over the data, thereby aligning the result with the original array.
  </p>
  <p>
   Note that for the kernel to be centered, it must be symmetric about the point K(FLOOR(
   <i>
    m
   </i>
   /2)), where
   <i>
    m
   </i>
   is the number of elements in the kernel.
  </p>
  <h3 class="Keyword">
   <a name="EDGE_MIR">
   </a>
   EDGE_MIRROR
  </h3>
  <p>
   Set this keyword to make CONVOL compute the values of elements at the edge of
   <i>
    Array
   </i>
   by “mirroring” the subscripts of
   <i>
    Array
   </i>
   at the edge. For example, if CENTER= 0:
  </p>
  <p>
   <img src="../images/convol3.gif" style="width: 393px;height: 117px;" />
  </p>
  <p>
   If none of the EDGE_* keywords are set, CONVOL sets the values of
   <i>
    Result
   </i>
   to zero (or the value of BIAS) where the kernel extends beyond the edge.
  </p>
  <h3 class="Keyword">
   <a name="C_854643309_746326">
   </a>
   <a name="C_854643309_746326_Keywords_CONVOL__">
   </a>
   EDGE_TRUNCATE
  </h3>
  <p>
   Set this keyword to make CONVOL compute the values of elements at the edge of
   <i>
    Array
   </i>
   by repeating the subscripts of
   <i>
    Array
   </i>
   at the edge. For example, if CENTER is set to zero:
  </p>
  <p style="text-align: left;">
   <img src="../../images/9_13.jpg" />
  </p>
  <p>
   where
   <i>
    n
   </i>
   is the number of elements in
   <i>
    Array
   </i>
   . The “&lt;” and “&gt;” operators in the above formula return the smaller and larger of their operands, respectively.
  </p>
  <p>
   If none of the EDGE_* keywords are set, CONVOL sets the values of
   <span class="_Override" style="font-style: italic;">
    Result
   </span>
   to zero (or the value of
   <a class="MCXref_Heading_0" href="#C_854643309_1297165">
    BIAS
   </a>
   ) where the kernel extends beyond the edge.
  </p>
  <h3 class="Keyword">
   <a name="C_854643309_1298048">
   </a>
   <a name="C_854643309_228821_Keywords_CONVOL__">
   </a>
   EDGE_WRAP
  </h3>
  <p>
   Set this keyword to make CONVOL compute the values of elements at the edge of
   <i>
    Array
   </i>
   by “wrapping” the subscripts of
   <i>
    Array
   </i>
   at the edge. For example, if CENTER is set to zero:
  </p>
  <p style="text-align: left;">
   <img src="../../images/9_12.gif" style="width: 291px;height: 68px;" />
  </p>
  <p>
   where
   <i>
    n
   </i>
   is the number of elements in
   <i>
    Array
   </i>
   . The mod operator in the formula above is defined as
   <span class="Courier">
    a mod b = a - b * floor(a/b)
   </span>
   . For example, -1 mod 5 is 4.
  </p>
  <p>
   If none of the EDGE_* keywords are set, CONVOL sets the values of
   <span class="_Override" style="font-style: italic;">
    Result
   </span>
   to zero (or the value of
   <a class="MCXref_Heading_0" href="#C_854643309_1297165">
    BIAS
   </a>
   ) where the kernel extends beyond the edge.
  </p>
  <h3 class="Keyword">
   <a name="C_854643309_1297184">
   </a>
   <a name="C_854643309_26786">
   </a>
   EDGE_ZERO
  </h3>
  <p>
   Set this keyword to make CONVOL compute the values of elements at the edge of
   <span class="_Override" style="font-style: italic;">
    Array
   </span>
   as if the array were padded with zeroes. For example, if
   <a class="MCXref_Heading_0" href="#C_854643309_676409">
    CENTER
   </a>
   is set to zero:
  </p>
  <p style="text-align: left;">
   <img src="../../images/9_21.jpg" />
  </p>
  <p>
   If none of the EDGE_* keywords are set, CONVOL sets the values of
   <span class="_Override" style="font-style: italic;">
    Result
   </span>
   to zero (or the value of
   <a class="MCXref_Heading_0" href="#C_854643309_1297165">
    BIAS
   </a>
   ) where the kernel extends beyond the edge.
  </p>
  <h3 class="Keyword">
   <a name="C_854643309_1297467">
   </a>
   <a name="C_854643309_85402">
   </a>
   INVALID
  </h3>
  <p>
   Set this keyword to a scalar value of the same type as
   <span class="_Override" style="font-style: italic;">
    Array
   </span>
   that should be used to indicate missing or invalid data within
   <span class="_Override" style="font-style: italic;">
    Array
   </span>
   . Missing data are ignored when computing the convolution for neighboring elements. In
   <span class="_Override" style="font-style: italic;">
    Result
   </span>
   , missing elements are replaced by the convolution of all other valid points within the kernel. If all points within the kernel are missing, the result at that point is given by the value of the
   <a class="MCXref_Heading_0" href="#C_854643309_1028668">
    MISSING
   </a>
   keyword.
  </p>
  <p class="Tip" madcap:autonum="&lt;b&gt;Tip: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Tip:
     </b>
    </span>
   </span>
   The INVALID keyword has the same effect as the
   <a class="MCXref_Heading_0" href="#C_854643309_1028683">
    NAN
   </a>
   keyword, but is useful for byte or integer data which have missing values.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   The INVALID keyword uses a simple comparison to ignore values and should not be set to NaN. For floating-point data, you can use the
   <a class="MCXref_Heading_0" href="#C_854643309_1297467">
    INVALID
   </a>
   and
   <a class="MCXref_Heading_0" href="#C_854643309_1028683">
    NAN
   </a>
   keywords simultaneously to filter out both user-defined values and NaN or Infinity values.
  </p>
  <h3 class="Keyword">
   <a name="C_854643309_1028668">
   </a>
   <a name="C_854643309_1028668_Keywords_CONVOL__">
   </a>
   MISSING
  </h3>
  <p>
   Set this keyword to the numeric value to return for elements that contain no valid points within the kernel. The default is zero for byte or integer input, and NaN for floating-point input. This keyword is only used if the INVALID or NAN keyword is set.
  </p>
  <h3 class="Keyword">
   <a name="C_854643309_1028683">
   </a>
   <a name="C_854643309_1028683_Keywords_CONVOL__">
   </a>
   NAN
  </h3>
  <p>
   Set this keyword to cause the routine to check for occurrences of the IEEE floating-point values
   <i>
    NaN
   </i>
   or
   <i>
    Infinity
   </i>
   in the input data. Elements with the value
   <i>
    NaN
   </i>
   or
   <i>
    Infinity
   </i>
   are treated as missing data. Missing data are ignored when computing the convolution for neighboring elements. In the
   <i>
    Result
   </i>
   , missing elements are replaced by the convolution of all other valid points within the kernel. If all points within the kernel are missing, then the result at that point is given by the MISSING keyword.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   CONVOL should never be called without the NAN keyword if the input array may possibly contain
   <i>
    NaN
   </i>
   or
   <i>
    Infinity
   </i>
   values.
  </p>
  <h3 class="Keyword">
   <a name="C_854643309_1297207">
   </a>
   <a name="C_854643309_34350">
   </a>
   NORMALIZE
  </h3>
  <p>
   Set this keyword to automatically compute a scale factor and bias and apply them to the result values. If this keyword is set, the
   <span class="_Override" style="font-style: italic;">
    Scale_Factor
   </span>
   argument and the
   <a class="MCXref_Heading_0" href="#C_854643309_1297165">
    BIAS
   </a>
   keyword are ignored. For all input types, the scale factor is defined as the sum of the absolute values of
   <span class="_Override" style="font-style: italic;">
    Kernel
   </span>
   . For BYTE or UINT, the bias is defined as the sum of the absolute values of the negative
   <span class="_Override" style="font-style: italic;">
    Kernel
   </span>
   values, multiplied by either (255/
   <span class="_Override" style="font-style: italic;">
    Scale
   </span>
   ) for BYTE or (65535/
   <span class="_Override" style="font-style: italic;">
    Scale
   </span>
   ) for UINT, where
   <span class="_Override" style="font-style: italic;">
    Scale
   </span>
   is the computed scale factor. For all other types, the bias is zero.
  </p>
  <p class="Tip" madcap:autonum="&lt;b&gt;Tip: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Tip:
     </b>
    </span>
   </span>
   If NORMALIZE is set and your input array has missing data (the
   <a class="MCXref_Heading_0" href="#C_854643309_1297467">
    INVALID
   </a>
   or
   <a class="MCXref_Heading_0" href="#C_854643309_1028683">
    NAN
   </a>
   keywords are set), for each result value the scale factor and bias are computed using only those kernel values that contributed to that result value. This ensures that all result values are comparable in magnitude, regardless of any missing data.
  </p>
  <h3>
   Thread Pool Keywords
  </h3>
  <p>
   This routine is written to make use of IDL’s
   <i>
    thread pool
   </i>
   , which can increase execution speed on systems with multiple CPUs. The values stored in the !CPU system variable control whether IDL uses the thread pool for a given computation. In addition, you can use the thread pool keywords TPOOL_MAX_ELTS, TPOOL_MIN_ELTS, and TPOOL_NOTHREAD to override the defaults established by !CPU for a single invocation of this routine.  See
   <a class="MCXref_Chapter_Reference_0" href="../../Creating IDL Programs/Appendices/tpoolkeyw.html#tpoolkeyw_2501860834_317209" target="" title="" alt="">
    Thread Pool Keywords
   </a>
   for details.
  </p>
  <h2 class="API">
   <a name="C_854643309_1297673">
   </a>
   <a name="C_854643309_746333_PageTOC_CONVOL_">
   </a>
   Additional Examples
   <img src="../../images/convol_example2.gif" class="ImgFloatRight" />
  </h2>
  <p>
   This example smoothes a noisy image that has missing data and uses the
   <a class="MCXref_Heading_0" href="#C_854643309_1297207">
    NORMALIZE
   </a>
   keyword to automatically remove much of the missing data.
  </p>
  <p class="Code">
   ; Array with noise
  </p>
  <p class="Code">
   array = HANNING(300,300) + 0.1*RANDOMN(seed,300,300)
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Convert to bytes from [0, 254]
  </p>
  <p class="Code">
   array = BYTSCL(array, TOP=254)
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Add some missing scanlines, plus a large region
  </p>
  <p class="Code">
   ; Use 255 as the missimg data value
  </p>
  <p class="Code">
   array[*, RANDOMU(seed,40)*300] = 255
  </p>
  <p class="Code">
   array[*, 10:20] = 255
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Simple 5x5 Gaussian kernel
  </p>
  <p class="Code">
   kernel = GAUSSIAN_FUNCTION([1,1], WIDTH=5, MAXIMUM=255)
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Values of 255 are flagged as invalid (missing)
  </p>
  <p class="Code">
   ; and replaced by 0 if there are no valid values
  </p>
  <p class="Code">
   ; within the kernel
  </p>
  <p class="Code">
   result = CONVOL(array, kernel, INVALID=255, MISSING=0, $
  </p>
  <p class="Code">
   &#160;&#160;/EDGE_ZERO, /NORMALIZE)
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   i2 = IMAGE(array, LAYOUT = [2, 1, 1], RGB_TABLE=39)
  </p>
  <p class="Code">
   i2 = IMAGE(result, LAYOUT = [2, 1, 2], RGB_TABLE=39, /CURRENT)
  </p>
  <h2 class="API">
   <a name="C_854643309_1297681">
   </a>
   <a name="C_854643309_34603_PageTOC_CONVOL_">
   </a>
   Version History
  </h2>
  <table style="width: 499px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
   <col width="91px" />
   <col width="408px" />
   <tbody>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_ColSep">
      <p>
       Original
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_ColEnd">
      <p>
       Introduced
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_RowSep_ColSep">
      <p>
       6.2
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_RowSep_ColEnd">
      <p>
       Added BIAS, EDGE_ZERO, INVALID, and NORMALIZE keywords
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
      <p>
       8.1
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
      <p>
       Added EDGE_MIRROR keyword
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <h2 class="API">
   <a name="C_854643309_1052213">
   </a>
   <a name="C_854643309_1052213_PageTOC_CONVOL_">
   </a>
   See Also
  </h2>
  <p>
   <a class="MCXref_Heading_0" href="../B/BLK_CON.html#B_856805997_908043">
    BLK_CON
   </a>
  </p>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>