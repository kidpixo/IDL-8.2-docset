<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="IDL Programming|Interfaces (Widgets)|About Property Sheet Widgets" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-US" xml:lang="en-US" madcap:pathtohelpsystem="../../../" madcap:helpsystemfilename="idl.xml" madcap:searchtype="Stem">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   User-defined Properties
  </title>
  <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
  <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../idl_CSH.html#Creating IDL Programs/Creating Applications in IDL/User_defined_Properties.html" style="">
    Open topic with navigation
   </a>
  </p>
  <div class="MCBreadcrumbsBox_0">
   <span class="MCBreadcrumbsPrefix">
    <![CDATA[ ]]>
   </span>
   <a class="MCBreadcrumbsLink" href="../../IDL Programming.html">
    IDL Programming
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="Widget Application Techniques.html">
    Interfaces (Widgets)
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="About_Property_Sheet_Wid.html">
    About Property Sheet Widgets
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <span class="MCBreadcrumbs">
    User-defined Properties
   </span>
  </div>
  <h1>
   <a name="widget_propertysheet_3756481120_128293">
   </a>
   <a name="widget_propertysheet_3756481120_67328">
   </a>
   User-defined Properties
   <a name="kanchor4930">
   </a>
  </h1>
  <p>
   User-defined properties allow IDL programmers to provide their own custom means for editing a property. One significant difference from other types of properties is that user-defined properties must have a string version of their value. This string value is stored in the USERDEF attribute of the property and must be explicitly updated. The string value is the value displayed in the property sheet.
  </p>
  <h2 class="API">
   Updating User-defined Properties
  </h2>
  <p>
   Like other property types, user-defined properties generate IDL property sheet change events. The difference is that the IDL event handler cannot query the property sheet for the new value. It must use some other means to determine a new value. Typically this is done through widget code, in which the user is asked to set a value, but virtually any other technique is valid.
  </p>
  <p>
   When handling change events, determine the property’s type using the PROPTYPE field of the widget event structure. Once a value has been acquired, update the component using its SetProperty method. In addition, the string version of the user-defined property’s value should be updated. This is done by executing a statement similar to the following example:
  </p>
  <p class="Code">
   eventBase.component-&gt;SetPropertyAttribute, $
  </p>
  <p class="Code">
   &#160;&#160;&#160;eventBase.identifier, USERDEF = userDefValue
  </p>
  <p>
   where
   <span class="Courier">
    eventBase
   </span>
   is the event structure of the top-level-base and
   <span class="Courier">
    userDefValue
   </span>
   is the string representing the user-defined value when the property sheet is refreshed.
  </p>
  <p>
   Once the underlying component has been updated, the property sheet is ready to be refreshed. Execute a call to update a given property with the current value:
  </p>
  <p class="Code">
   WIDGET_CONTROL, propsheet, REFRESH_PROPERTY = eventBase.identifier
  </p>
  <p>
   where
   <span class="Courier">
    propsheet
   </span>
   is the widget ID of the property sheet widget and
   <span class="Courier">
    eventBase
   </span>
   is the event structure of the top-level-base.
  </p>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>