<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="Additional Topics|Medical Imaging in IDL|IDL DICOM Reference|IDLffDicomEx" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-US" xml:lang="en-US" madcap:pathtohelpsystem="../../../" madcap:helpsystemfilename="idl.xml" madcap:searchtype="Stem">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   IDLffDicomEx::GetPrivateValueLength
  </title>
  <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
  <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
  <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../idl_CSH.html#DICOM_Medical/IDL DICOM Reference/IDLffDicomEx__GetPrivateValueLength.html" style="">
    Open topic with navigation
   </a>
  </p>
  <div class="MCBreadcrumbsBox_0">
   <span class="MCBreadcrumbsPrefix">
    <![CDATA[ ]]>
   </span>
   <a class="MCBreadcrumbsLink" href="../../OtherTopics.html">
    Additional Topics
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="../Expanded DICOM Support in IDL/ExpandedDICOMFunctionality.html">
    Medical Imaging in IDL
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="DICOMEX_GETCONFIGFILEPAT.html">
    IDL DICOM Reference
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <span class="MCBreadcrumbs">
    IDLffDicomEx::GetPrivateValueLength
   </span>
  </div>
  <h1 class="ObjMethod">
   IDLffDicomEx::GetPrivateValueLength
  </h1>
  <p>
   The IDLffDicomEx::GetPrivateValueLength function method returns the length of all values or of a specified value (in bytes) in a private DICOM attribute. This method uses a private code defined by the author of the private tag, a group number, and part of the element tag instead of a standard DICOM attribute tag to identify the private DICOM attribute.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   GetPrivateValueLength will fail if you attempt to return a value for an attribute that does not exist or an attribute that has been removed. If you are not sure if an attribute exists use
   <a href="IDLffDicomEx__QueryPrivateValue.html" class="MCXref_0">
    IDLffDicomEx::QueryPrivateValue
   </a>
   before calling GetPrivateValueLength.
  </p>
  <h2 class="API">
   <a name="dicom_ex_4010397576_1007638">
   </a>
   <a name="dicom_ex_4010397576_1007638_PageTOC_IDLffDicomEx">
   </a>
   Syntax
  </h2>
  <p class="Syntax">
   <span class="Italic">
    Result = Obj
   </span>
   -&gt;[
   <a href="IDLffDicomEx.html" class="MCXref_0">
    IDLffDicomEx
   </a>
   ::]GetPrivateValueLength(
   <span class="Italic">
    PrivateCode
   </span>
   ,
   <span class="Italic">
    Group
   </span>
   ,
   <span class="Italic">
    Element
   </span>
   [,&#160;
   <a href="#dicom_ex_4010397576_1007653" class="MCXref_0">
    SEQID
   </a>
   =
   <span class="Italic">
    integer
   </span>
   ] [,&#160;
   <a href="#dicom_ex_4010397576_1007657" class="MCXref_0">
    VALUEINDEX
   </a>
   =
   <span class="Italic">
    integer
   </span>
   ]&#160;)
  </p>
  <h2 class="API">
   <a name="dicom_ex_4010397576_1007640">
   </a>
   <a name="dicom_ex_4010397576_1007640_PageTOC_IDLffDicomEx">
   </a>
   Return Value
  </h2>
  <p>
   Returns a long integer indicating the length of one of the following:
  </p>
  <ul>
   <li value="1">
    The length (in bytes) of all values when the VAULEINDEX keyword is not set
   </li>
   <li value="2">
    The length (in bytes) of a single value specified by the VALUEINDEX keyword
   </li>
   <li value="3">
    The number of repeating groups contained within a sequence if the
    <span class="Italic">
     PrivateCode
    </span>
    ,
    <span class="Italic">
     Group
    </span>
    and
    <span class="Italic">
     Element
    </span>
    arguments identify a sequence.
   </li>
  </ul>
  <h2 class="API">
   <a name="dicom_ex_4010397576_1007645">
   </a>
   <a name="dicom_ex_4010397576_1007645_PageTOC_IDLffDicomEx">
   </a>
   Arguments
  </h2>
  <h3 class="Argument">
   PrivateCode
  </h3>
  <p>
   A string identification code that identifies the private block of data. Within a given private group
   <span class="Italic">
    PrivateCode
   </span>
   labels are stored sequentially in the element addresses ranging from '0010' to '00FF'. For example, the string value stored at DICOM tag address '0029,0010' is the
   <span class="Italic">
    PrivateCode
   </span>
   for the block of data tagged at '0029,1000'&#160;&#8209;&#160;'0029,10FF'. The label stored at '0029,0011' would be the
   <span class="Italic">
    PrivateCode
   </span>
   for the data in tags '0029,1100' - '0029,11 FF'.
  </p>
  <h3 class="Argument">
   Group
  </h3>
  <p>
   A string identifying the group tag number of the private attribute (the first four digits of a DICOM tag). This must be an odd number and in the form 'XXXX'.
  </p>
  <h3 class="Argument">
   Element
  </h3>
  <p>
   A string identifying the last two digits of the element associated with the private attribute. This must be in the form 'XX'. Valid values are 10 - FF.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   The first two digits of the
   <span class="Italic">
    Element
   </span>
   are implicit in the
   <span class="Italic">
    PrivateCode
   </span>
   argument.
  </p>
  <h2 class="API">
   <a name="dicom_ex_4010397576_1007652">
   </a>
   <a name="dicom_ex_4010397576_1007652_PageTOC_IDLffDicomEx">
   </a>
   Keywords
  </h2>
  <h3 class="Keyword">
   <a name="dicom_ex_4010397576_1007653">
   </a>
   <a name="dicom_ex_4010397576_72816">
   </a>
   SEQID
  </h3>
  <p>
   Set this keyword only if the private attribute exists within a sequence. Use this keyword to specify sequence identifier as follows:
  </p>
  <ul>
   <li value="1">
    Set to a non-zero value (a sequence identifier) indicating the sequence in which the value is contained. This sequence identifier may have been returned via a previous call to the GetPrivateValue method.
   </li>
   <li value="2">
    Set to 0 or do not specify this keyword to indicate the private attribute exists at the root level of the DICOM file. This is the default.
   </li>
  </ul>
  <h3 class="Keyword">
   <a name="dicom_ex_4010397576_1007657">
   </a>
   <a name="dicom_ex_4010397576_68453">
   </a>
   VALUEINDEX
  </h3>
  <p>
   Set this keyword to an integer indicating the one-based index number of the value for which to return the length. If not set, this method returns the length of a single value for a single-valued attribute, or the length of all values for a multi-valued attribute.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   An error will be issued if you specify a value larger than the number of values in the private attribute.
  </p>
  <h2 class="API">
   <a name="dicom_ex_4010397576_1007662">
   </a>
   <a name="dicom_ex_4010397576_1007662_PageTOC_IDLffDicomEx">
   </a>
   Examples
  </h2>
  <p>
   The following example adds private tags to the clone of a selected DICOM file, and commits this file to memory. It then queries for a private
   <a name="kanchor5014">
   </a>
   sequence to make sure it exists and proceeds to use GetPrivateValue (to return a vector of sequence identifiers, one for each group) and GetPrivateValueLength (to return the number of repeating groups) to access the length and value of a private attribute that is repeated within the sequence.
  </p>
  <p class="Code">
   PRO print_tags_doc, vTags, vTagCnt
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Format the output.
  </p>
  <p class="Code">
   PRINT, FORMAT= $
  </p>
  <p class="Code">
   '(%"%3s, %2s, %-12s, %3s, %5s, %12s, %15s")', $
  </p>
  <p class="Code">
   'IDX', 'LVL', 'TAG',  'VR', 'SEQID', $
  </p>
  <p class="Code">
   'DESCRIPTION', 'VALUE'
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Cycle through the tags.
  </p>
  <p class="Code">
   FOR xx = 0, vTagCnt-1  DO BEGIN
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; If the item is nested within another item, indicate the
  </p>
  <p class="Code">
   ; level using &gt; symbol.
  </p>
  <p class="Code">
   IF (vTags[xx].Level GT 0) THEN BEGIN
  </p>
  <p class="Code">
   &#160;&#160;&#160;&#160;&#160;&#160;vLvl = STRJOIN(REPLICATE('&gt;',vTags[xx].Level))
  </p>
  <p class="Code">
   vtg =  vLvl + vTags[xx].Tag
  </p>
  <p class="Code">
   ENDIF ELSE BEGIN
  </p>
  <p class="Code">
   vtg = vTags[xx].Tag
  </p>
  <p class="Code">
   ENDELSE
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; If the tags are in a group, indicate this.
  </p>
  <p class="Code">
   IF (vTags[xx].GroupNum GT 0) THEN BEGIN
  </p>
  <p class="Code">
   PRINT, FORMAT='(%"%15s, %1d")', 'Group', vTags[xx].GroupNum
  </p>
  <p class="Code">
   ENDIF
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Print the fields of the structure.
  </p>
  <p class="Code">
   PRINT, FORMAT = $
  </p>
  <p class="Code">
   '(%"%3d, %2d, %-12s, %3s, %5s, %12s, %15s")', $
  </p>
  <p class="Code">
   xx, vTags[xx].Level, vtg, vTags[xx].VR, $
  </p>
  <p class="Code">
   vTags[xx].SeqId, vTags[xx].Description, $
  </p>
  <p class="Code">
   vTags[xx].Value
  </p>
  <p class="Code">
   ENDFOR
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   END
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   PRO dicom_getprivate_length_doc
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Select a DICOM file.
  </p>
  <p class="Code">
   sFile = DIALOG_PICKFILE( $
  </p>
  <p class="Code">
   PATH=FILEPATH('',SUBDIRECTORY=['examples','data']), $
  </p>
  <p class="Code">
   TITLE='Select DICOM Patient File', FILTER='*.dcm', $
  </p>
  <p class="Code">
   GET_PATH=path)
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Create a clone (aImgClone.dcm) of the selected file (sfile).
  </p>
  <p class="Code">
   oImg = OBJ_NEW('IDLffDicomEx', path + 'aImgClone.dcm', $
  </p>
  <p class="Code">
   CLONE=sfile)
  </p>
  <p class="Code">
   ; Add two sets of repeating tags (groups) to a private sequence
  </p>
  <p class="Code">
   ; (0051, 0012), which is created by AddPrivateGroup. This sequence
  </p>
  <p class="Code">
   ; exists at the root-level of the DICOM file. Add two sets of
  </p>
  <p class="Code">
   ; repeating tags to the root sequence.
  </p>
  <p class="Code">
   vGrp1 = oImg-&gt;AddPrivateGroup('Root Private SQ', '0051', '12')
  </p>
  <p class="Code">
   oImg-&gt;SetPrivateValue, 'Root Private SQ', '0051', '14', 'ST', $
  </p>
  <p class="Code">
   'gr1Tag1', SEQID=vGrp1
  </p>
  <p class="Code">
   oImg-&gt;SetPrivateValue, 'Root Private SQ', '0051', '15', 'ST', $
  </p>
  <p class="Code">
   'gr1Tag2', SEQID=vGrp1
  </p>
  <p class="Code">
   vGrp2 = oImg-&gt;AddPrivateGroup('Root Private SQ', '0051', '12')
  </p>
  <p class="Code">
   oImg-&gt;SetPrivateValue, 'Root Private SQ', '0051', '14', 'ST', $
  </p>
  <p class="Code">
   'gr2Tag1', SEQID=vGrp2
  </p>
  <p class="Code">
   oImg-&gt;SetPrivateValue, 'Root Private SQ', '0051', '15', 'ST', $
  </p>
  <p class="Code">
   'gr2Tag2', SEQID=vGrp2
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Print a range including the new tags to
  </p>
  <p class="Code">
   ; the Output Log window.
  </p>
  <p class="Code">
   vTags = oImg-&gt;EnumerateTags(COUNT=vTagCnt, $
  </p>
  <p class="Code">
   START_TAG='0051,0000', STOP_TAG='0057,0000')
  </p>
  <p class="Code">
   print_tags_doc, vTags, vTagCnt
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Commit the changes.
  </p>
  <p class="Code">
   oImg-&gt;Commit
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Make sure the private sequence exists.
  </p>
  <p class="Code">
   vQuery = oImg-&gt;QueryPrivateValue('Root Private SQ', '0051', '12')
  </p>
  <p class="Code">
   If vQuery NE 0 THEN BEGIN
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Retrive the sequence identifier, lost after a commit. When the
  </p>
  <p class="Code">
   ; sequence contains multiple groups, this returns an zero based
  </p>
  <p class="Code">
   ; vector of sequence identifiers, one for each group.
  </p>
  <p class="Code">
   vSeqId = oImg-&gt;GetPrivateValue('Root Private SQ', '0051', '12')
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Return the number of sets of repeating tags in the private
  </p>
  <p class="Code">
   ; sequence. This value is used to access a private value in
  </p>
  <p class="Code">
   ; each group.
  </p>
  <p class="Code">
   vSeqLength = oImg-&gt;GetPrivateValueLength('Root Private SQ', $
  </p>
  <p class="Code">
   '0051', '12')
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   For i = 1, vSeqLength do begin
  </p>
  <p class="Code">
   ; Return the length and value of each private attribute.
  </p>
  <p class="Code">
   vLength = oImg-&gt;GetPrivateValueLength('Root Private SQ', $
  </p>
  <p class="Code">
   '0051', '14', SEQID=vSeqId[i-1])
  </p>
  <p class="Code">
   vResult = oImg-&gt;GetPrivateValue('Root Private SQ', $
  </p>
  <p class="Code">
   '0051', '14', SEQID=vSeqId[i-1])
  </p>
  <p class="Code">
   Print, 'Sequence group ', i, + '(0051,1014) length is ', $
  </p>
  <p class="Code">
   vLength, + ' and value is ', vResult
  </p>
  <p class="Code">
   ENDFOR
  </p>
  <p class="Code">
   ENDIF
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Clean up references.
  </p>
  <p class="Code">
   OBJ_DESTROY, oImg
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Note: the following line allows you to run the project
  </p>
  <p class="Code">
   ; multiple times without having to manually delete the file.
  </p>
  <p class="Code">
   ; You cannot duplicate an existing file when creating or cloning
  </p>
  <p class="Code">
   ; a DICOM file.
  </p>
  <p class="Code">
   FILE_DELETE, path + 'aImgClone.dcm', /ALLOW_NONEXISTENT
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   END
  </p>
  <p>
   The following appears in the Output Log window.
  </p>
  <p class="Code">
   IDX, LV, TAG         ,  VR, SEQID,  DESCRIPTION,           VALUE
  </p>
  <p class="Code">
   0,  0, 0051,0010   ,  LO,      ,             , Root Private SQ
  </p>
  <p class="Code">
   1,  0, 0051,1012   ,  SQ,      ,             ,
  </p>
  <p class="Code">
   Group, 1
  </p>
  <p class="Code">
   2,  1, &gt;0051,0010  ,  LO,      ,             , Root Private SQ
  </p>
  <p class="Code">
   3,  1, &gt;0051,1014  ,  ST,      ,             ,         gr1Tag1
  </p>
  <p class="Code">
   4,  1, &gt;0051,1015  ,  ST,      ,             ,         gr1Tag2
  </p>
  <p class="Code">
   Group, 2
  </p>
  <p class="Code">
   5,  1, &gt;0051,0010  ,  LO,      ,             , Root Private SQ
  </p>
  <p class="Code">
   6,  1, &gt;0051,1014  ,  ST,      ,             ,         gr2Tag1
  </p>
  <p class="Code">
   7,  1, &gt;0051,1015  ,  ST,      ,             ,         gr2Tag2
  </p>
  <p class="Code">
   Sequence group 1(0051,1014) length is 8 and value is gr1Tag1
  </p>
  <p class="Code">
   Sequence group 2(0051,1014) length is 8 and value is gr2Tag1
  </p>
  <h2 class="API">
   <a name="dicom_ex_4010397576_1036928">
   </a>
   <a name="dicom_ex_4010397576_1036928_PageTOC_IDLffDicomEx">
   </a>
   Version History
  </h2>
  <table style="width: 499px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
   <col width="91px" />
   <col width="408px" />
   <tbody>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
      <p>
       6.1
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
      <p>
       Introduced
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>