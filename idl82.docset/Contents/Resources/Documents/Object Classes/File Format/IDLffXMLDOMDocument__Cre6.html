<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="IDL Programming|Objects|File Format Object Classes|IDLffXMLDOMDocument" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-US" xml:lang="en-US" madcap:pathtohelpsystem="../../../" madcap:helpsystemfilename="idl.xml" madcap:searchtype="Stem">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   IDLffXMLDOMDocument::CreateNodeIterator
  </title>
  <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../Resources/TableStyles/Description.css" rel="stylesheet" />
  <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
  <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
  <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../idl_CSH.html#Object Classes/File Format/IDLffXMLDOMDocument__Cre6.html" style="">
    Open topic with navigation
   </a>
  </p>
  <div class="MCBreadcrumbsBox_0">
   <span class="MCBreadcrumbsPrefix">
    <![CDATA[ ]]>
   </span>
   <a class="MCBreadcrumbsLink" href="../../IDL Programming.html">
    IDL Programming
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="../ref_part2.html">
    Objects
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="objects_ff.html">
    File Format Object Classes
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <span class="MCBreadcrumbs">
    IDLffXMLDOMDocument::CreateNodeIterator
   </span>
  </div>
  <h1 class="ObjMethod">
   <a name="objects_ff_3755668711_1268876">
   </a>
   <a name="objects_ff_3755668711_17097">
   </a>
   IDLffXMLDOMDocument::CreateNodeIterator
  </h1>
  <p>
   The IDLffXMLDOMDocument::
   <a name="kanchor3975">
   </a>
   CreateNodeIterator function method is used to create an instance of an
   <a class="MCXref_Heading_0" href="IDLffXMLDOMNodeIterator.html#objects_ff_3755668711_1264182">
    IDLffXMLDOMNodeIterator
   </a>
   object. This function returns an object reference to that instance.
  </p>
  <p>
   Please note the following exceptions in node iteration:
  </p>
  <ul>
   <li value="1">
    Attributes are never children of DOM nodes, so they are not visited by the node iterator. Showing attributes is only meaningful when the iterator root node is an attribute.
   </li>
   <li value="2">
    Entities are not part of the DOM tree, so they are not visited by the node iterator. Showing entities is only meaningful when the iterator root node is an entity.
   </li>
   <li value="3">
    Notations are not part of the DOM tree, so they are not visited by the node iterator. Showing notations is only meaningful when the iterator root node is a notation.
   </li>
  </ul>
  <h2 class="API">
   Syntax
  </h2>
  <p class="Syntax">
   <span class="_Override" style="font-style: italic;">
    Result
   </span>
   =
   <span class="_Override" style="font-style: italic;">
    Obj
   </span>
   -&gt;[
   <a class="MCXref_Heading_0" href="IDLffXMLDOMDocument.html#objects_ff_3755668711_1104965">
    IDLffXMLDOMDocument
   </a>
   ::]CreateNodeIterator(
   <span class="_Override" style="font-style: italic;">
    RootNode
   </span>
   <br />
   [,&#160;
   <a class="MCXref_Heading_0" href="#objects_ff_3755668711_1272913">
    FILTER_NAME
   </a>
   =
   <span class="_Override" style="font-style: italic;">
    string
   </span>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#objects_ff_3755668711_1272973">
    FILTER_USERDATA
   </a>
   =
   <span class="_Override" style="font-style: italic;">
    variable
   </span>
   ]
   <br />
   [,&#160;
   <a class="MCXref_Heading_0" href="#objects_ff_3755668711_1272980">
    WHAT_TO_SHOW
   </a>
   =
   <span class="_Override" style="font-style: italic;">
    value
   </span>
   ] )
  </p>
  <h2 class="API">
   Arguments
  </h2>
  <h3 class="Argument">
   RootNode
  </h3>
  <p>
   An object reference to an object that is a subclass of
   <a class="MCXref_Heading_0" href="IDLffXMLDOMNode.html#objects_ff_3755668711_1105014">
    IDLffXMLDOMNode
   </a>
   that refers to a node in the DOM tree. The iterator's current position is set immediately before this node. If this object reference is NULL, the iterator's current position is set immediately before the document node.
  </p>
  <h2 class="API">
   Keywords
  </h2>
  <h3 class="Keyword">
   <a name="objects_ff_3755668711_1272913">
   </a>
   <a name="objects_ff_3755668711_16451">
   </a>
   FILTER_NAME
  </h3>
  <p>
   Set this keyword to a scalar string containing the name of an IDL function that is called each time the iterator is about to visit a node. The purpose of this function is to allow the iterator to ask the IDL application if it should visit a particular node, and hence return it in response to an
   <a class="MCXref_Heading_0" href="IDLffXMLDOMNodeIterator_2.html#objects_ff_3755668711_1273428">
    IDLffXMLDOMNodeIterator::NextNode
   </a>
   or
   <a class="MCXref_Heading_0" href="IDLffXMLDOMNodeIterator_3.html#objects_ff_3755668711_1273463">
    IDLffXMLDOMNodeIterator::PreviousNode
   </a>
   method call. The code in this function should analyze the incoming node and then return a value that instructs the iterator to accept or reject the node.
  </p>
  <p>
   If this keyword is not specified, the node iterator visits every node.
  </p>
  <p>
   Nodes that are accepted are returned by
   <a class="MCXref_Heading_0" href="IDLffXMLDOMNodeIterator_2.html#objects_ff_3755668711_1273428">
    IDLffXMLDOMNodeIterator::NextNode
   </a>
   and
   <a class="MCXref_Heading_0" href="IDLffXMLDOMNodeIterator_3.html#objects_ff_3755668711_1273463">
    IDLffXMLDOMNodeIterator::PreviousNode
   </a>
   . Nodes that are rejected are not returned by these methods.
  </p>
  <p>
   The filter function is called by the iterator for the given node after the determinations are made with respect to the
   <a class="MCXref_Heading_0" href="#objects_ff_3755668711_1272980">
    WHAT_TO_SHOW
   </a>
   setting. Therefore, the filter function is not called for nodes that are rejected by the
   <a class="MCXref_Heading_0" href="#objects_ff_3755668711_1272980">
    WHAT_TO_SHOW
   </a>
   property.
  </p>
  <p>
   The filter function specified by FILTER_NAME must have the following parameters:
  </p>
  <ul>
   <li value="1">
    <span class="_Override" style="font-weight: bold;">
     Node Object
    </span>
    — an object reference to an instance of an
    <a class="MCXref_Heading_0" href="IDLffXMLDOMNode.html#objects_ff_3755668711_1105014">
     IDLffXMLDOMNode
    </a>
    subclass. This parameter is required and is supplied by the iterator on every call.
   </li>
   <li value="2">
    <span class="_Override" style="font-weight: bold;">
     USERDATA
    </span>
    — an optional keyword parameter set by the iterator to a variable containing a copy of the data provided in the
    <a class="MCXref_Heading_0" href="#objects_ff_3755668711_1272973">
     FILTER_USERDATA
    </a>
    keyword. If
    <a class="MCXref_Heading_0" href="#objects_ff_3755668711_1272973">
     FILTER_USERDATA
    </a>
    is not specified, USERDATA is not passed by the iterator.
   </li>
  </ul>
  <p>
   The function must return one of three scalar integer values:
  </p>
  <table style="width: 499px;caption-side: bottom;mc-table-style: url('../../Resources/TableStyles/Description.css');" cellspacing="0" class="TableStyle_Description">
   <caption valign="bottom" style="padding-bottom: 12pt;">
   </caption>
   <p class="TableTitle">
    Return Values for CreateNodeIterator’s Filter Function
   </p>
   <col width="120px" />
   <col width="379px" />
   <thead>
    <tr>
     <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
      <p>
       Value
      </p>
     </td>
     <td class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
      <p>
       Function
      </p>
     </td>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       1
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       ACCEPT: this node is visited by the node iterator
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       2
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       REJECT: this node is not visited by the node iterator
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
      <p>
       3
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowEnd_ColEnd">
      <p>
       SKIP: this node is not visited by the node iterator (same as REJECT)
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <p>
   SKIP and REJECT have the same meanings for a node iterator, but have different meanings for a tree walker. This makes it possible for a single filter function to be used with either a node iterator or tree walker. If the function returns a value that is not supported, the iterator visits the node, as if the return value was 1 (ACCEPT). If the function returns a value that cannot be converted to a scalar, IDL throws an error.
  </p>
  <p>
   The function should not destroy the node object passed as the first parameter.
  </p>
  <h3 class="Keyword">
   <a name="objects_ff_3755668711_1272973">
   </a>
   <a name="objects_ff_3755668711_49597">
   </a>
   FILTER_USERDATA
  </h3>
  <p>
   Set this keyword to an IDL variable containing data to pass to the filter function each time the iterator calls the filter function. The iterator creates a copy of this variable to pass on each call.
  </p>
  <p>
   Supplying this keyword without
   <a class="MCXref_Heading_0" href="#objects_ff_3755668711_1272913">
    FILTER_NAME
   </a>
   produces no effect on the iterator.
  </p>
  <h3 class="Keyword">
   <a name="objects_ff_3755668711_1272980">
   </a>
   <a name="objects_ff_3755668711_55080">
   </a>
   WHAT_TO_SHOW
  </h3>
  <p>
   Set this keyword to a scalar unsigned integer containing a bitmask, where each bit indicates types of nodes that the iterator visits. If this keyword is not specified, the node iterator visits every node.
  </p>
  <table style="width: 480px;caption-side: bottom;mc-table-style: url('../../Resources/TableStyles/Description.css');" cellspacing="0" class="TableStyle_Description">
   <caption valign="bottom" style="padding-bottom: 12pt;">
   </caption>
   <p class="TableTitle">
    Bitmasks for CreateNodeIterator’s WHAT_TO_SHOW Keyword
   </p>
   <col width="192px" />
   <col width="144px" />
   <col width="144px" />
   <thead>
    <tr>
     <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
      <p>
       Type
      </p>
     </td>
     <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
      <p>
       Value (Hex)
      </p>
     </td>
     <td class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
      <p>
       Value (Decimal)
      </p>
     </td>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       ALL
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       ‘ffff’xu
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       65535U
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       Element
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       ‘0001’xu
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       1U
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       Attribute
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       ‘0002’xu
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       2U
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       Text
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       ‘0004’xu
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       4U
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       CDATA Section
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       ‘0008’xu
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       8U
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       Entity Reference
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       ‘0010’xu
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       16U
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       Entity
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       ‘0020’xu
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       32U
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       Processing Instruction
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       ‘0040’xu
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       64U
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       Comment
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       ‘0080’xu
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       128U
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       Document
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       ‘0100’xu
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       256U
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       Document Type
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       ‘0200’xu
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       512U
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       Document Fragment
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       ‘0400’xu
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       1024U
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
      <p>
       Notation
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
      <p>
       ‘0800’xu
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowEnd_ColEnd">
      <p>
       2048U
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <p>
   The node iterator performs the WHAT_TO_SHOW test for a node before calling any user-provided filter function.
  </p>
  <h2 class="API">
   Version History
  </h2>
  <table style="width: 499px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
   <col width="91px" />
   <col width="408px" />
   <tbody>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
      <p>
       6.2
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
      <p>
       Introduced
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>