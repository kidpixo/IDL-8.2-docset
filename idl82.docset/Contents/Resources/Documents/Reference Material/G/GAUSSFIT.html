<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="Routines (alphabetical)|Routines: G" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-US" xml:lang="en-US" madcap:pathtohelpsystem="../../../" madcap:helpsystemfilename="idl.xml" madcap:searchtype="Stem">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   GAUSSFIT
  </title>
  <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
  <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
  <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../idl_CSH.html#Reference Material/G/GAUSSFIT.html" style="">
    Open topic with navigation
   </a>
  </p>
  <div class="MCBreadcrumbsBox_0">
   <span class="MCBreadcrumbsPrefix">
    <![CDATA[ ]]>
   </span>
   <a class="MCBreadcrumbsLink" href="../../images/ref_part1.html">
    Routines (alphabetical)
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="G_list.html">
    Routines: G
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <span class="MCBreadcrumbs">
    GAUSSFIT
   </span>
  </div>
  <h1 class="Routine">
   <a name="G_845992557_749954">
   </a>
   <a name="G_845992557_49956">
   </a>
   GAUSSFIT
  </h1>
  <p madcap:conditions="Reference Material.Online_Help_Only">
   <madcap:conditionaltext madcap:conditions="Reference Material.Online_Help_Only">
    <a class="MCXref_Heading_0" href="#G_845992557_749966">
     Syntax
    </a>
    |
    <a class="MCXref_Heading_0" href="#G_845992557_884390">
     Return Value
    </a>
    |
    <a class="MCXref_Heading_0" href="#G_845992557_925882">
     Arguments
    </a>
    |
    <a class="MCXref_Heading_0" href="#G_845992557_841703">
     Keywords
    </a>
    |
    <a class="MCXref_Heading_0" href="#G_845992557_871297">
     Examples
    </a>
    |
    <a class="MCXref_Heading_0" href="#G_845992557_34757">
     Version History
    </a>
    |
    <a class="MCXref_Heading_0" href="#G_845992557_881340">
     See Also
    </a>
   </madcap:conditionaltext>
  </p>
  <p>
   The
   <a name="kanchor1034">
   </a>
   GAUSSFIT function computes a non-linear
   <a name="kanchor1035">
   </a>
   least-squares fit to a function
   <i>
    f
   </i>
   &#160;(
   <i>
    x
   </i>
   ) with from three to six unknown parameters.
   <i>
    f
   </i>
   &#160;(
   <i>
    x
   </i>
   ) is a linear combination of a Gaussian and a quadratic; the number of terms is controlled by the keyword parameter NTERMS.
  </p>
  <p>
   This routine is written in the IDL language. Its source code can be found in the file
   <span class="Courier">
    gaussfit.pro
   </span>
   in the
   <span class="Courier">
    lib
   </span>
   subdirectory of the IDL distribution.
  </p>
  <h2 class="API">
   <a name="G_845992557_749966">
   </a>
   <a name="G_845992557_749966_PageTOC_GAUSSFIT_">
   </a>
   Syntax
  </h2>
  <p class="Syntax">
   <i>
    Result
   </i>
   = GAUSSFIT(
   <i>
    X
   </i>
   ,
   <i>
    Y
   </i>
   [,&#160;
   <i>
    A
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#G_845992557_881490">
    CHISQ
   </a>
   =
   <i>
    variable
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#G_845992557_841704">
    ESTIMATES
   </a>
   =
   <i>
    array
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#G_845992557_841712">
    MEASURE_ERRORS
   </a>
   =
   <i>
    vector
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#G_845992557_889863">
    NTERMS
   </a>
   =
   <i>
    integer
   </i>
   {3 to 6}] [,&#160;
   <a class="MCXref_Heading_0" href="#G_845992557_881498">
    SIGMA
   </a>
   =
   <i>
    variable
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#G_845992557_881500">
    YERROR
   </a>
   =
   <i>
    variable
   </i>
   ])
  </p>
  <h2 class="API">
   <a name="G_845992557_884390">
   </a>
   <a name="G_845992557_58522">
   </a>
   Return Value
  </h2>
  <p>
   Returns three to six values that are the non-linear least squares fit to a function
   <i>
    f
   </i>
   &#160;(
   <i>
    x
   </i>
   ).
  </p>
  <h2 class="API">
   <a name="G_845992557_925882">
   </a>
   <a name="G_845992557_749968_PageTOC_GAUSSFIT_">
   </a>
   Arguments
  </h2>
  <h3 class="Argument">
   X
  </h3>
  <p>
   An
   <i>
    n
   </i>
   -element vector containing the independent variable values.
   <i>
    X
   </i>
   may be of type integer, floating point, or double-precision floating-point.
  </p>
  <h3 class="Argument">
   Y
  </h3>
  <p>
   A vector of dependent variables, the same length as
   <i>
    X
   </i>
   .
  </p>
  <h3 class="Argument">
   A
  </h3>
  <p>
   A named variable that will contain the coefficients
   <i>
    A
   </i>
   of the fit.
  </p>
  <h2 class="API">
   <a name="G_845992557_841703">
   </a>
   <a name="G_845992557_841703_PageTOC_GAUSSFIT_">
   </a>
   Keywords
  </h2>
  <h3 class="Keyword">
   <a name="G_845992557_881490">
   </a>
   <a name="G_845992557_881490_Keywords_GAUSSFIT__">
   </a>
   CHISQ
  </h3>
  <p>
   Set this keyword to a named variable that will contain the value of the reduced chi-square goodness-of-fit statistic.
  </p>
  <h3 class="Keyword">
   <a name="G_845992557_841704">
   </a>
   <a name="G_845992557_841704_Keywords_GAUSSFIT__">
   </a>
   ESTIMATES
  </h3>
  <p>
   Set this keyword equal to an array of starting estimates for the parameters of the equation. If the NTERMS keyword is specified, the ESTIMATES array should have NTERMS elements. If NTERMS is not specified, the ESTIMATES array should have six elements. If the ESTIMATES array is not specified, estimates are calculated by first subtracting a constant (if NTERMS &gt;= 4) or a linear term (if NTERMS &gt;= 5), and then forming a simple estimate of the Gaussian coefficients.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   If ESTIMATES[2] (the Gaussian width) is zero, then GAUSSFIT will automatically compute a best guess for the starting value for this term.
  </p>
  <h3 class="Keyword">
   <a name="G_845992557_841712">
   </a>
   <a name="G_845992557_841712_Keywords_GAUSSFIT__">
   </a>
   MEASURE_ERRORS
  </h3>
  <p>
   Set this keyword to a vector containing standard measurement errors for each point
   <i>
    Y
   </i>
   [
   <i>
    i
   </i>
   ]. This vector must be the same length as
   <i>
    X
   </i>
   and
   <i>
    Y
   </i>
   .
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   For Gaussian errors (e.g., instrumental uncertainties), MEASURE_ERRORS should be set to the standard deviations of each point in
   <i>
    Y
   </i>
   . For Poisson or statistical weighting, MEASURE_ERRORS should be set to SQRT(
   <i>
    Y
   </i>
   ).
  </p>
  <h3 class="Keyword">
   <a name="G_845992557_889863">
   </a>
   <a name="G_845992557_889863_Keywords_GAUSSFIT__">
   </a>
   NTERMS
  </h3>
  <p>
   Set this keyword to an integer value between three and six to specify the function to be used for the fit. The values correspond to the functions shown below. In all cases:
  </p>
  <p style="text-align: left;">
   <img src="../../images/13_18.jpg" />
  </p>
  <h4>
   NTERMS=6
  </h4>
  <p style="text-align: left;">
   <img src="../../images/13_19.jpg" />
  </p>
  <h4>
   NTERMS=5
  </h4>
  <p style="text-align: left;">
   <img src="../../images/13_20.jpg" />
  </p>
  <h4>
   NTERMS=4
  </h4>
  <p style="text-align: left;">
   <img src="../../images/13_21.jpg" />
  </p>
  <h4>
   NTERMS=3
  </h4>
  <p style="text-align: left;">
   <img src="../../images/13_22.jpg" />
  </p>
  <p>
   NTERMS=6 is the default setting. Here, A0 is the height of the Gaussian, A1 is the center of the Gaussian, A2 is the width (the standard deviation) of the Gaussian, A3 is the constant term, A4 is the linear term, and A5 is the quadratic term.
  </p>
  <p class="Tip" madcap:autonum="&lt;b&gt;Tip: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Tip:
     </b>
    </span>
   </span>
   The full width at half maximum (FWHM) of the Gaussian may be computed as 2*SQRT(2*ALOG(2))*A2.
  </p>
  <h3 class="Keyword">
   <a name="G_845992557_881498">
   </a>
   <a name="G_845992557_881498_Keywords_GAUSSFIT__">
   </a>
   SIGMA
  </h3>
  <p>
   Set this keyword to a named variable that will contain the 1-sigma error estimates of the returned parameters.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   If MEASURE_ERRORS is omitted, then you are assuming that a polynomial is the correct model for your data, and therefore, no independent goodness-of-fit test is possible. In this case, the values returned in SIGMA are multiplied by SQRT(CHISQ/(
   <i>
    N
   </i>
   *
   <i>
    M
   </i>
   )), where
   <i>
    N
   </i>
   is the number of points in
   <i>
    X
   </i>
   , and
   <i>
    M
   </i>
   is the number of coefficients. See Section 15.2 of
   <i>
    Numerical Recipes in C (Second Edition)
   </i>
   for details.
  </p>
  <h3 class="Keyword">
   <a name="G_845992557_881500">
   </a>
   <a name="G_845992557_881500_Keywords_GAUSSFIT__">
   </a>
   YERROR
  </h3>
  <p>
   Set this keyword to a named variable that will contain the standard error between YFIT and Y.
  </p>
  <h2 class="API">
   <a name="G_845992557_871297">
   </a>
   <a name="G_845992557_871297_PageTOC_GAUSSFIT_">
   </a>
   Examples
  </h2>
  <p>
   The following example shows how to use GAUSSFIT to fit to four different functions, with NTERMS=3,4,5,6. To simulate actual data, random noise has been added to each function.
  </p>
  <p class="Code">
   pro ex_gaussfit
   <br />
   <br />
   &#160;&#160;&#160;; Define the independent variable.
   <br />
   &#160;&#160;&#160;n = 101
   <br />
   &#160;&#160;&#160;x = (FINDGEN(n)-(n/2))/4
   <br />
   <br />
   &#160;&#160;&#160;; Define the coefficients.
   <br />
   &#160;&#160;&#160;a = [4.0, 1.0, 2.0, 1.0, 0.25, 0.01]
   <br />
   &#160;&#160;&#160;print, 'Expected: ', a
   <br />
   &#160;&#160;&#160;z = (x - a[1])/a[2]    ; Gaussian variable
   <br />
   &#160;&#160;&#160;!P.MULTI = [0,2,2]     ; set up 2x2 plot window
   <br />
   &#160;&#160;&#160;seed = 123321          ; Pick a starting seed value
   <br />
   <br />
   &#160;&#160;&#160;for nterms=3,6 do begin
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;; Define the dependent variables. Start with random noise.
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;y = 0.4*RANDOMN(seed, n)
   <br />
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;; Use a switch statement so we fall through to each term.
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;switch nterms of
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;6: y = y + a[5]*x^2
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;5: y = y + a[4]*x
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;4: y = y + a[3]
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;3: y = y + a[0]*exp(-z^2/2)
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;endswitch
   <br />
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;; Fit the data to the function, storing coefficients in
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;; coeff:
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;yfit = GAUSSFIT(x, y, coeff, NTERMS=nterms)
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;print, 'Result:   ', coeff[0:nterms-1]
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;; Plot the original data and the fitted curve:
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;PLOT, x, y, TITLE='nterms='+STRTRIM(nterms,2)
   <br />
   &#160;&#160;&#160;&#160;&#160;&#160;OPLOT, x, yfit, THICK=2
   <br />
   &#160;&#160;&#160;endfor
   <br />
   end
  </p>
  <p>
   When this program is compiled and executed, IDL prints the following results:
  </p>
  <p class="Code">
   IDL&gt; ex_gaussfit
  </p>
  <p class="Code">
   Expected: 4.00000 1.00000 2.00000 1.00000 0.250000 0.0100000
  </p>
  <p class="Code">
   Result: 3.95437 1.03176 2.07216
  </p>
  <p class="Code">
   Result: 4.38669 0.948479 1.84426 0.909676
  </p>
  <p class="Code">
   Result: 3.93348 0.839296 2.02112 1.05237 0.249002
  </p>
  <p class="Code">
   Result: 3.80389 0.993375 2.07302 1.16684 0.249051 0.0484357
  </p>
  <h2 class="API">
   <a name="G_845992557_34757">
   </a>
   <a name="G_845992557_34757_PageTOC_GAUSSFIT_">
   </a>
   Version History
  </h2>
  <table style="width: 499px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
   <col width="91px" />
   <col width="408px" />
   <tbody>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_ColSep">
      <p>
       Original
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_ColEnd">
      <p>
       Introduced
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_RowSep_ColSep">
      <p>
       5.6
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_RowSep_ColEnd">
      <p>
       Added CHISQ, SIGMA, and YERROR keywords
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
      <p>
       6.0
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
      <p>
       Added MEASURE_ERRORS keyword
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <h2 class="API">
   <a name="G_845992557_881340">
   </a>
   <a name="G_845992557_881340_PageTOC_GAUSSFIT_">
   </a>
   See Also
  </h2>
  <p>
   <a class="MCXref_Heading_0" href="../C/COMFIT.html#C_854643309_53189">
    COMFIT
   </a>
   ,
   <a class="MCXref_Heading_0" href="../C/CURVEFIT.html#C_854643309_749660">
    CURVEFIT
   </a>
   ,
   <a class="MCXref_Heading_0" href="GAUSS2DFIT.html#G_845992557_197913">
    GAUSS2DFIT
   </a>
   ,
   <a class="MCXref_Heading_0" href="../P/POLY_FIT.html#P_817877613_753815">
    POLY_FIT
   </a>
   ,
   <a class="MCXref_Heading_0" href="../R/REGRESS.html#R_822202989_1102676">
    REGRESS
   </a>
   ,
   <a class="MCXref_Heading_0" href="../S/SFIT.html#S_820040301_36073">
    SFIT
   </a>
   ,
   <a class="MCXref_Heading_0" href="../S/SVDFIT.html#S_820040301_154010">
    SVDFIT
   </a>
  </p>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>