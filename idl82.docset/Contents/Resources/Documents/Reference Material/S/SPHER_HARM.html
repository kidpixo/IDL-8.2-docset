<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="Routines (alphabetical)|Routines: S" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-US" xml:lang="en-US" madcap:pathtohelpsystem="../../../" madcap:helpsystemfilename="idl.xml" madcap:searchtype="Stem">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   SPHER_HARM
  </title>
  <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../Resources/TableStyles/Figure_Format.css" rel="stylesheet" />
  <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
  <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
  <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../idl_CSH.html#Reference Material/S/SPHER_HARM.html" style="">
    Open topic with navigation
   </a>
  </p>
  <div class="MCBreadcrumbsBox_0">
   <span class="MCBreadcrumbsPrefix">
    <![CDATA[ ]]>
   </span>
   <a class="MCBreadcrumbsLink" href="../../images/ref_part1.html">
    Routines (alphabetical)
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="S_list.html">
    Routines: S
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <span class="MCBreadcrumbs">
    SPHER_HARM
   </span>
  </div>
  <h1 class="Routine">
   <a name="S_820040301_1136752">
   </a>
   <a name="S_820040301_86750">
   </a>
   SPHER_HARM
  </h1>
  <p madcap:conditions="Reference Material.Online_Help_Only">
   <madcap:conditionaltext madcap:conditions="Reference Material.Online_Help_Only">
    <a class="MCXref_Heading_0" href="#S_820040301_1098242">
     Syntax
    </a>
    |
    <a class="MCXref_Heading_0" href="#S_820040301_1098244">
     Return Value
    </a>
    |
    <a class="MCXref_Heading_0" href="#S_820040301_1098247">
     Arguments
    </a>
    |
    <a class="MCXref_Heading_0" href="#S_820040301_1098256">
     Keywords
    </a>
    |
    <a class="MCXref_Heading_0" href="#S_820040301_1098259">
     Examples
    </a>
    |
    <a class="MCXref_Heading_0" href="#S_820040301_1098302">
     Version History
    </a>
    |
    <a class="MCXref_Heading_0" href="#S_820040301_1110381">
     See Also
    </a>
   </madcap:conditionaltext>
  </p>
  <p>
   The
   <a name="kanchor2436">
   </a>
   SPHER_HARM function returns the value of the
   <a name="kanchor2437">
   </a>
   spherical harmonic
   <i>
    Y
   </i>
   <sub class="italic">
    lm
   </sub>
   (θ,φ), -
   <i>
    l
   </i>
   &#160;≤&#160;
   <i>
    m
   </i>
   &#160;≤&#160;
   <i>
    l
   </i>
   ,
   <i>
    l
   </i>
   &#160;≥&#160;0, which is a function of two coordinates on a spherical surface.
  </p>
  <p>
   The spherical harmonics are related to the associated Legendre polynomial by:
  </p>
  <p style="text-align: center;">
   <img src="../../images/25_21.jpg" />
  </p>
  <p>
   For negative
   <i>
    m
   </i>
   the following relation is used:
  </p>
  <p style="text-align: center;">
   <img src="../../images/25_22.jpg" />
  </p>
  <p>
   where * represents the complex conjugate.
  </p>
  <p>
   This routine is written in the IDL language. Its source code can be found in the file
   <span class="Courier">
    spher_harm.pro
   </span>
   in the
   <span class="Courier">
    lib
   </span>
   subdirectory of the IDL distribution.
  </p>
  <h2 class="API">
   <a name="S_820040301_1098242">
   </a>
   <a name="S_820040301_1098242_PageTOC_SPHER_HARM__">
   </a>
   Syntax
  </h2>
  <p class="Syntax">
   <i>
    Result
   </i>
   = SPHER_HARM(
   <i>
    Theta
   </i>
   ,
   <i>
    Phi
   </i>
   ,
   <i>
    L
   </i>
   ,
   <i>
    M
   </i>
   , [,&#160;/
   <a class="MCXref_Heading_0" href="#S_820040301_1098257">
    DOUBLE
   </a>
   ] )
  </p>
  <h2 class="API">
   <a name="S_820040301_1098244">
   </a>
   <a name="S_820040301_1098244_PageTOC_SPHER_HARM__">
   </a>
   Return Value
  </h2>
  <p>
   SPHER_HARM returns a complex scalar or array containing the value of the spherical harmonic function. The return value has the same dimensions as the input arguments
   <i>
    Theta
   </i>
   and
   <i>
    Phi
   </i>
   . If one argument (
   <i>
    Theta
   </i>
   or
   <i>
    Phi
   </i>
   ) is a scalar and the other argument is an array, the function uses the scalar value with each element of the array, and returns an array with the same dimensions as the input array.
  </p>
  <p>
   If either
   <i>
    Theta
   </i>
   or
   <i>
    Phi
   </i>
   are double-precision or if the DOUBLE keyword is set, the result is double-precision complex, otherwise the result is single-precision complex.
  </p>
  <h2 class="API">
   <a name="S_820040301_1098247">
   </a>
   <a name="S_820040301_1098247_PageTOC_SPHER_HARM__">
   </a>
   Arguments
  </h2>
  <h3 class="Argument">
   Theta
  </h3>
  <p>
   The value of the polar (colatitudinal) coordinate θ at which
   <i>
    Y
   </i>
   <sub class="italic">
    lm
   </sub>
   (θ,φ)
   <span class="Symbol">
   </span>
   is evaluated.
   <i>
    Theta
   </i>
   can be either a scalar or an array.
  </p>
  <h3 class="Argument">
   Phi
  </h3>
  <p>
   The value of the azimuthal (longitudinal) coordinate φ at which
   <i>
    Y
   </i>
   <sub class="italic">
    lm
   </sub>
   (θ,φ) is evaluated.
   <i>
    Phi
   </i>
   can be either a scalar or an array.
  </p>
  <h3 class="Argument">
   L
  </h3>
  <p>
   A scalar integer, L ≥ 0, specifying the order
   <i>
    l
   </i>
   of
   <i>
    Y
   </i>
   <sub class="italic">
    lm
   </sub>
   (θ,φ). If
   <i>
    L
   </i>
   is of type float, it will be truncated.
  </p>
  <h3 class="Argument">
   M
  </h3>
  <p>
   A scalar integer, –
   <i>
    L
   </i>
   ≤
   <i>
    M
   </i>
   ≤
   <i>
    L
   </i>
   , specifying the azimuthal order
   <i>
    m
   </i>
   of
   <i>
    Y
   </i>
   <sub class="italic">
    lm
   </sub>
   (θ,φ). If
   <i>
    M
   </i>
   is of type float, it will be truncated.
  </p>
  <h2 class="API">
   <a name="S_820040301_1098256">
   </a>
   <a name="S_820040301_1098256_PageTOC_SPHER_HARM__">
   </a>
   Keywords
  </h2>
  <h3 class="Keyword">
   <a name="S_820040301_1098257">
   </a>
   <a name="S_820040301_1098257_Keywords_SPHER_HARM__">
   </a>
   DOUBLE
  </h3>
  <p>
   Set this keyword to force the computation to be done in double-precision arithmetic.
  </p>
  <h2 class="API">
   <a name="S_820040301_1098259">
   </a>
   <a name="S_820040301_1098259_PageTOC_SPHER_HARM__">
   </a>
   Examples
  </h2>
  <p>
   This example visualizes the electron probability density for the hydrogen atom in state 3d0. (Feynman, Leighton, and Sands, 1965: The Feynman Lectures on Physics, Calif. Inst. Tech, Ch. 19). The first part of this example defines the data and converts it from rectangular to spherical:
  </p>
  <p class="Code">
   ; Define a data cube (N x N x N)
   <br />
   n = 41L
   <br />
   a = 60*FINDGEN(n)/(n-1) - 29.999  ; [-1,+1]
   <br />
   x = REBIN(a, n, n, n)              ; X-coordinates of cube
   <br />
   y = REBIN(REFORM(a,1,n), n, n, n)  ; Y-coordinates
   <br />
   z = REBIN(REFORM(a,1,1,n), n, n, n); Z-coordinates
   <br />
   <br />
   ; Convert from rectangular (x,y,z) to spherical (phi, theta, r)
   <br />
   spherCoord = CV_COORD(FROM_RECT= $
   <br />
   TRANSPOSE([[x[*]],[y[*]],[z[*]]]), /TO_SPHERE)
   <br />
   phi = REFORM(spherCoord[0,*], n, n, n)
   <br />
   theta = REFORM(!PI/2 - spherCoord[1,*], n, n, n)
   <br />
   r = REFORM(spherCoord[2,*], n, n, n)
  </p>
  <p>
   The next part computes the electron probability density and radial component, then displays the data:
  </p>
  <p class="Code">
   ; Find electron probability density for hydrogen atom in state 3d0
   <br />
   ; Angular component
   <br />
   L = 2   ; state "d" is electron spin L=2
   <br />
   M = 0   ; Z-component of spin is zero
   <br />
   angularState = SPHER_HARM(theta, phi, L, M)
   <br />
   ; Radial component for state n=3, L=2
   <br />
   radialFunction = EXP(-r/2)*(r^2)
   <br />
   waveFunction = angularState*radialFunction
   <br />
   probabilityDensity = ABS(waveFunction)^2
   <br />
   <br />
   SHADE_VOLUME, probabilityDensity, $
   <br />
   0.1*MEAN(probabilityDensity), vertex, poly
   <br />
   oPolygon = OBJ_NEW('IDLgrPolygon', vertex, $
   <br />
   POLYGON=poly, COLOR=[180,180,180])
   <br />
   XOBJVIEW, oPolygon
  </p>
  <p>
   The results are shown in the following figure (rotated in XOBJVIEW for clarity):
  </p>
  <table style="width: 517px;caption-side: bottom;mc-table-style: url('../../Resources/TableStyles/Figure_Format.css');" class="TableStyle_Figure_Format" cellspacing="0">
   <caption valign="bottom" style="padding-bottom: 12pt;">
   </caption>
   <p class="FigureTitle">
    SPHER_HARM Example of Hydrogen Atom
    <br />
    (object rotated in XOBJVIEW for clarity)
   </p>
   <col width="517px" />
   <tbody>
    <tr>
     <td class="TableStyle_Figure_Format_Body_0_0_RowEnd_ColEnd">
      <p>
       &#160;
      </p>
      <p style="text-align: center;">
       <img src="../../images/spher3.gif" style="margin-left: 5.99976px;margin-right: 5.999752px;" />
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <h2 class="API">
   <a name="S_820040301_1098302">
   </a>
   <a name="S_820040301_1098302_PageTOC_SPHER_HARM__">
   </a>
   Version History
  </h2>
  <table style="width: 499px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
   <col width="91px" />
   <col width="408px" />
   <tbody>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
      <p>
       5.4
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
      <p>
       Introduced
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <h2 class="API">
   <a name="S_820040301_1110381">
   </a>
   <a name="S_820040301_1110381_PageTOC_SPHER_HARM__">
   </a>
   See Also
  </h2>
  <p>
   <a class="MCXref_Heading_0" href="../L/LEGENDRE.html#L_826528365_942535">
    LEGENDRE
   </a>
   ,
   <a class="MCXref_Heading_0" href="../L/LAGUERRE.html#L_826528365_942451">
    LAGUERRE
   </a>
  </p>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>