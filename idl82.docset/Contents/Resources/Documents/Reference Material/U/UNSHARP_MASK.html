<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="Routines (alphabetical)|Routines: U" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-US" xml:lang="en-US" madcap:pathtohelpsystem="../../../" madcap:helpsystemfilename="idl.xml" madcap:searchtype="Stem">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   UNSHARP_MASK
  </title>
  <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
  <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
  <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../idl_CSH.html#Reference Material/U/UNSHARP_MASK.html" style="">
    Open topic with navigation
   </a>
  </p>
  <div class="MCBreadcrumbsBox_0">
   <span class="MCBreadcrumbsPrefix">
    <![CDATA[ ]]>
   </span>
   <a class="MCBreadcrumbsLink" href="../../images/ref_part1.html">
    Routines (alphabetical)
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="U_list.html">
    Routines: U
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <span class="MCBreadcrumbs">
    UNSHARP_MASK
   </span>
  </div>
  <h1 class="Routine">
   <a name="U_807064173_966134">
   </a>
   <a name="U_807064173_36272">
   </a>
   UNSHARP_MASK
  </h1>
  <p madcap:conditions="Reference Material.Online_Help_Only">
   <madcap:conditionaltext madcap:conditions="Reference Material.Online_Help_Only">
    <a class="MCXref_Heading_0" href="#U_807064173_968696">
     Syntax
    </a>
    |
    <a class="MCXref_Heading_0" href="#U_807064173_968710">
     Return Value
    </a>
    |
    <a class="MCXref_Heading_0" href="#U_807064173_968712">
     Arguments
    </a>
    |
    <a class="MCXref_Heading_0" href="#U_807064173_968715">
     Keywords
    </a>
    |
    <a class="MCXref_Heading_0" href="#U_807064173_968731">
     UNSHARP_MASK
    </a>
    |
    <a class="MCXref_Heading_0" href="#U_807064173_968747">
     Version History
    </a>
    |
    <a class="MCXref_Heading_0" href="#U_807064173_968749">
     See Also
    </a>
   </madcap:conditionaltext>
  </p>
  <p>
   The
   <a name="kanchor2662">
   </a>
   UNSHARP_MASK function performs an unsharp-mask sharpening filter on a two-dimensional array or a TrueColor image. For TrueColor images the unsharp mask is applied to each channel.
  </p>
  <p>
   The unsharp mask algorithm works by enhancing the contrast between neighboring pixels in an image, and is widely used for astronomical images and for digital photographs.
  </p>
  <p>
   The algorithm involves the following steps:
  </p>
  <table class="AutoNumber_p_Numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
   <col style="width: 16px;" />
   <col style="width: 24px;" />
   <col style="width: auto;" />
   <tr>
    <td valign="top">
    </td>
    <td class="AutoNumber_p_Numbered1" valign="top">
     <span>
      1.
     </span>
    </td>
    <td class="AutoNumber_p_Numbered1" madcap:autonum="1. " valign="top">
     Smooth the original image with a Gaussian filter, with the width controlled by the RADIUS keyword.
    </td>
   </tr>
  </table>
  <table class="AutoNumber_p_Numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
   <col style="width: 16px;" />
   <col style="width: 24px;" />
   <col style="width: auto;" />
   <tr>
    <td valign="top">
    </td>
    <td class="AutoNumber_p_Numbered1" valign="top">
     <span>
      2.
     </span>
    </td>
    <td class="AutoNumber_p_Numbered1" madcap:autonum="2. " valign="top">
     Subtract the smoothed image from the original to create a high-pass filtered image.
    </td>
   </tr>
  </table>
  <table class="AutoNumber_p_Numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
   <col style="width: 16px;" />
   <col style="width: 24px;" />
   <col style="width: auto;" />
   <tr>
    <td valign="top">
    </td>
    <td class="AutoNumber_p_Numbered1" valign="top">
     <span>
      3.
     </span>
    </td>
    <td class="AutoNumber_p_Numbered1" madcap:autonum="3. " valign="top">
     Apply any clipping needed on the high-pass image, as controlled by the THRESHOLD keyword.
    </td>
   </tr>
  </table>
  <table class="AutoNumber_p_Numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
   <col style="width: 16px;" />
   <col style="width: 24px;" />
   <col style="width: auto;" />
   <tr>
    <td valign="top">
    </td>
    <td class="AutoNumber_p_Numbered1" valign="top">
     <span>
      4.
     </span>
    </td>
    <td class="AutoNumber_p_Numbered1" madcap:autonum="4. " valign="top">
     Add a certain percentage of the high-pass filtered image to the original image, with the percentage controlled by the AMOUNT keyword.
    </td>
   </tr>
  </table>
  <p>
   In pseudocode this algorithm can be written as:
  </p>
  <p class="Code">
   HighPass = Image - Convol ( Image, Gaussian )
  </p>
  <p class="Code">
   Result = Image + A * HighPass * ( |HighPass| ≥ T )
  </p>
  <p>
   where A is the amount, T is the threshold, and ≥ indicates a Boolean operation, 1 if true, or 0 otherwise.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   To avoid overflow for byte or integer data, the computations are performed using a larger integer type, the result is clipped to the minimum and maximum values for the original type, and the result is then converted back to the original type.
  </p>
  <p>
   This routine is written in the IDL language. Its source code can be found in the file
   <span class="Courier">
    unsharp_mask.pro
   </span>
   in the
   <span class="Courier">
    lib
   </span>
   subdirectory of the IDL distribution.
  </p>
  <h2 class="API">
   Example
   <img src="../images/unsharp_mask_ex1.gif" class="ImgFloatRight" />
  </h2>
  <p>
   This example sharpens an image of Mars by applying an unsharp mask filter:
  </p>
  <p class="Code">
   file = FILEPATH('marsglobe.jpg', SUBDIR=['examples','data'])
  </p>
  <p class="Code">
   READ_JPEG, file, marsImage
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Display the original image
  </p>
  <p class="Code">
   i = IMAGE(marsImage, LAYOUT = [2, 1, 1], DIMENSIONS = [800, 500])
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Display the unsharp-mask-filtered image
  </p>
  <p class="Code">
   result = UNSHARP_MASK(marsImage, RADIUS=4)
  </p>
  <p class="Code">
   i = IMAGE(result, LAYOUT = [2, 1, 2], /CURRENT)
  </p>
  <h2 class="API">
   <a name="U_807064173_968696">
   </a>
   <a name="U_807064173_968696_PageTOC_UNSHARP_MASK_">
   </a>
   Syntax
  </h2>
  <p class="Syntax">
   <i>
    Result
   </i>
   = UNSHARP_MASK(
   <i>
    Image
   </i>
   [,
   <a class="MCXref_Heading_0" href="#U_807064173_968717">
    AMOUNT
   </a>
   =
   <i>
    value
   </i>
   ] [,
   <a class="MCXref_Heading_0" href="#U_807064173_968720">
    RADIUS
   </a>
   =
   <i>
    value
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#U_807064173_968725">
    THRESHOLD
   </a>
   =
   <i>
    value
   </i>
   ] [,
   <a class="MCXref_Heading_0" href="#U_807064173_968729">
    TRUE
   </a>
   ={1|2|3}] )
  </p>
  <h2 class="API">
   <a name="U_807064173_968710">
   </a>
   <a name="U_807064173_968710_PageTOC_UNSHARP_MASK_">
   </a>
   Return Value
  </h2>
  <p>
   The
   <i>
    Result
   </i>
   is an array with the same dimensions and type as
   <i>
    Image
   </i>
   that contains the filtered image.
  </p>
  <h2 class="API">
   <a name="U_807064173_968712">
   </a>
   <a name="U_807064173_968712_PageTOC_UNSHARP_MASK_">
   </a>
   Arguments
  </h2>
  <h3 class="Argument">
   Image
  </h3>
  <p>
   The two-dimensional array or multichannel image to be filtered. If
   <i>
    Image
   </i>
   is a multichannel image, then the TRUE keyword may be used to indicate which dimension represents the channels.
  </p>
  <h2 class="API">
   <a name="U_807064173_968715">
   </a>
   <a name="U_807064173_968715_PageTOC_UNSHARP_MASK_">
   </a>
   Keywords
  </h2>
  <h3 class="Keyword">
   <a name="U_807064173_968717">
   </a>
   <a name="U_807064173_79073">
   </a>
   AMOUNT
  </h3>
  <p>
   Set this keyword to a floating-point value giving the amount (or strength) of filtering to be applied. The default is AMOUNT=1.0, which implies that 100% of the filter difference will be applied to the
   <i>
    Image
   </i>
   . AMOUNT may be negative, which will have the effect of blurring the image instead of sharpening.
  </p>
  <h3 class="Keyword">
   <a name="U_807064173_968720">
   </a>
   <a name="U_807064173_11081">
   </a>
   RADIUS
  </h3>
  <p>
   Set this keyword to a floating-point value giving the radius in pixels of the Gaussian smoothing filter. The default is RADIUS=3. The Gaussian filter is designed to fall to 1/e (~0.367) at a distance of RADIUS/sqrt(2). The total width of the Gaussian filter is given by ceil(3 * RADIUS)/2 * 2 + 1 (if RADIUS is an integer then this is just 3 * RADIUS + 1).
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   The value of RADIUS must be smaller than one-half of the largest array dimension.
  </p>
  <p class="Tip" madcap:autonum="&lt;b&gt;Tip: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Tip:
     </b>
    </span>
   </span>
   Use small RADIUS values (such as 3) for small images or images with fine details. Use larger RADIUS values for large images with larger details.
  </p>
  <h3 class="Keyword">
   <a name="U_807064173_968725">
   </a>
   <a name="U_807064173_98517">
   </a>
   THRESHOLD
  </h3>
  <p>
   Set this keyword to a non-negative integer (or a floating-point if
   <i>
    Image
   </i>
   is floating point) giving the clipping threshold. For each element, if the absolute value of the difference between the original image and the low-pass filtered array is greater than or equal to THRESHOLD then the filter is applied to that point. The default is THRESHOLD=0, which implies that every point will be filtered.
  </p>
  <p class="Tip" madcap:autonum="&lt;b&gt;Tip: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Tip:
     </b>
    </span>
   </span>
   Lower values of THRESHOLD will provide greater sharpening but may cause more speckling, while higher values of THRESHOLD will exclude regions of low contrast and cause less speckling.
  </p>
  <h3 class="Keyword">
   <a name="U_807064173_968729">
   </a>
   <a name="U_807064173_42529">
   </a>
   TRUE
  </h3>
  <p>
   If
   <i>
    Image
   </i>
   is a three-dimensional array (a multichannel image), set this keyword to 1, 2, or 3 to indicate which dimension represents the channels. The default is 1, for pixel interleaving, (3,
   <i>
    m
   </i>
   ,
   <i>
    n
   </i>
   ). A value of 2 indicates line interleaving (
   <i>
    m
   </i>
   , 3,
   <i>
    n
   </i>
   ), and 3 indicates band interleaving, (
   <i>
    m
   </i>
   ,
   <i>
    n
   </i>
   , 3).
  </p>
  <h2 class="API">
   <a name="U_807064173_968747">
   </a>
   <a name="U_807064173_968747_PageTOC_UNSHARP_MASK_">
   </a>
   Version History
  </h2>
  <table style="width: 499px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
   <col width="91px" />
   <col width="408px" />
   <tbody>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_ColSep">
      <p>
       6.1
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_ColEnd">
      <p>
       Introduced
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
      <p>
       7.1
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
      <p>
       Changed the total width definition of Gaussian filter from:
      </p>
      <p class="Code">
       ceil(2 * RADIUS)/2 * 2 +1
      </p>
      <p>
       to:
      </p>
      <p class="Code">
       ceil(3 * RADIUS)/2 * 2 +1
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <h2 class="API">
   <a name="U_807064173_968749">
   </a>
   <a name="U_807064173_968749_PageTOC_UNSHARP_MASK_">
   </a>
   See Also
  </h2>
  <p>
   <a class="MCXref_Heading_0" href="../C/CONVOL.html#C_854643309_676395">
    CONVOL
   </a>
   ,
   <a class="MCXref_Heading_0" href="../L/LEEFILT.html#L_826528365_758191">
    LEEFILT
   </a>
   ,
   <a class="MCXref_Heading_0" href="../R/ROBERTS.html#R_822202989_678584">
    ROBERTS
   </a>
   ,
   <a class="MCXref_Heading_0" href="../S/SOBEL.html#S_820040301_678928">
    SOBEL
   </a>
  </p>
  <p>
   &#160;
  </p>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>