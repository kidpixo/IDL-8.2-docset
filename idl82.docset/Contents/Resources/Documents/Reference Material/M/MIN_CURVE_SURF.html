<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="Routines (alphabetical)|Routines: M" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-US" xml:lang="en-US" madcap:pathtohelpsystem="../../../" madcap:helpsystemfilename="idl.xml" madcap:searchtype="Stem">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   MIN_CURVE_SURF
  </title>
  <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
  <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
  <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../idl_CSH.html#Reference Material/M/MIN_CURVE_SURF.html" style="">
    Open topic with navigation
   </a>
  </p>
  <div class="MCBreadcrumbsBox_0">
   <span class="MCBreadcrumbsPrefix">
    <![CDATA[ ]]>
   </span>
   <a class="MCBreadcrumbsLink" href="../../images/ref_part1.html">
    Routines (alphabetical)
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="M_list.html">
    Routines: M
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <span class="MCBreadcrumbs">
    MIN_CURVE_SURF
   </span>
  </div>
  <h1 class="Routine">
   <a name="M_824365677_888757">
   </a>
   <a name="M_824365677_65439">
   </a>
   MIN_CURVE_SURF
  </h1>
  <p madcap:conditions="Reference Material.Online_Help_Only">
   <madcap:conditionaltext madcap:conditions="Reference Material.Online_Help_Only">
    <a class="MCXref_Heading_0" href="#M_824365677_956516">
     Syntax
    </a>
    |
    <a class="MCXref_Heading_0" href="#M_824365677_956518">
     Return Value
    </a>
    |
    <a class="MCXref_Heading_0" href="#M_824365677_956267">
     Arguments
    </a>
    |
    <a class="MCXref_Heading_0" href="#M_824365677_888781">
     Keywords
    </a>
    |
    <a class="MCXref_Heading_0" href="#M_824365677_888810">
     Examples
    </a>
    |
    <a class="MCXref_Heading_0" href="#M_824365677_888822">
     Version History
    </a>
    |
    <a class="MCXref_Heading_0" href="#M_824365677_973005">
     See Also
    </a>
   </madcap:conditionaltext>
  </p>
  <p>
   The
   <a name="kanchor1887">
   </a>
   MIN_CURVE_SURF function
   <a name="kanchor1888">
   </a>
   interpolates a regularly- or irregularly-gridded set of points, over either a plane or a sphere, with either a
   <a name="kanchor1889">
   </a>
   minimum curvature surface or a
   <a name="kanchor1890">
   </a>
   thin-plate-
   <a name="kanchor1891">
   </a>
   spline surface.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   The accuracy of this function is limited by the single-precision floating-point accuracy of the machine.
  </p>
  <h3>
   Theory
  </h3>
  <p>
   A minimum curvature spline surface is fitted to the data points described by
   <i>
    x
   </i>
   ,
   <i>
    y
   </i>
   , and
   <i>
    z
   </i>
   . The basis function is:
  </p>
  <p>
   <i>
    &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;C
   </i>
   (
   <i>
    x
   </i>
   <sub class="italic">
    0
   </sub>
   ,
   <i>
    x
   </i>
   <sub class="italic">
    1
   </sub>
   ,
   <i>
    y
   </i>
   <sub class="italic">
    0
   </sub>
   ,
   <i>
    y
   </i>
   <sub class="italic">
    1
   </sub>
   )&#160;=&#160;d
   <sup>
    2
   </sup>
   log(d
   <sup class="italic">
    k
   </sup>
   )
  </p>
  <p>
   where
   <i>
    d
   </i>
   is the distance between (
   <i>
    x
   </i>
   <sub class="italic">
    0
   </sub>
   ,
   <i>
    y
   </i>
   <sub class="italic">
    0
   </sub>
   ), (
   <i>
    x
   </i>
   <sub class="italic">
    1
   </sub>
   ,
   <i>
    y
   </i>
   <sub class="italic">
    1
   </sub>
   ) and
   <i>
    k
   </i>
   = 1 for minimum curvature surface or
   <i>
    k
   </i>
   = 2 for Thin Plate Splines. For
   <i>
    n
   </i>
   data points, a system of
   <i>
    n
   </i>
   +3 simultaneous equations are solved for the coefficients of the surface. For any interpolation point, the interpolated value is:
  </p>
  <p style="text-align: center;">
   <img src="../../images/19_7.jpg" />
  </p>
  <p>
   For a sphere the value is:
  </p>
  <p style="text-align: center;">
   <img src="../../images/19_8.jpg" />
  </p>
  <p>
   On the sphere, l and t are longitude and latitude. C(L
   <sub class="italic">
    i
   </sub>
   ,l, T
   <sub class="italic">
    i
   </sub>
   ,t) is the basis function above, with distance between the two points, (L
   <sub class="italic">
    i
   </sub>
   ,T
   <sub class="italic">
    i
   </sub>
   ), and (l , t), measured in radians of arc length. x, y, and z are the 3D cartesian coordinates of the point (l,t) on the unit sphere.
  </p>
  <p>
   For a sphere with the CONST keyword set, the value is:
  </p>
  <p style="text-align: center;">
   <img src="../../images/19_9.jpg" />
  </p>
  <p>
   The results obtained with the thin plate spline (TPS) and the minimum curvature surface (MCS) methods are very similar. The only difference is in the basis functions: TPS uses d
   <sup>
    2
   </sup>
   *alog(d
   <sup>
    2
   </sup>
   ), and MCS uses d
   <sup>
    2
   </sup>
   *alog(d), where d is the distance from point (x
   <sub class="italic">
    i
   </sub>
   ,y
   <sub class="italic">
    i
   </sub>
   ).
  </p>
  <p>
   This routine is written in the IDL language. Its source code can be found in the file
   <span class="Courier">
    min_curve_surf.pro
   </span>
   in the
   <span class="Courier">
    lib
   </span>
   subdirectory of the IDL distribution.
  </p>
  <h2 class="API">
   <a name="M_824365677_956516">
   </a>
   <a name="M_824365677_956516_PageTOC_MIN_CURVE_SURF_">
   </a>
   Syntax
  </h2>
  <p class="Syntax">
   <i>
    Result
   </i>
   = MIN_CURVE_SURF(
   <i>
    Z
   </i>
   [,&#160;
   <i>
    X
   </i>
   ,
   <i>
    Y
   </i>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#M_824365677_929725">
    DOUBLE
   </a>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#M_824365677_888782">
    TPS
   </a>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#M_824365677_888785">
    REGULAR
   </a>
   ] [,&#160;/
   <a class="MCXref_Heading_0" href="#M_824365677_956689">
    SPHERE
   </a>
   [,&#160;/
   <a class="MCXref_Heading_0" href="#M_824365677_956696">
    CONST
   </a>
   ]] [,&#160;
   <a class="MCXref_Heading_0" href="#M_824365677_888787">
    XGRID
   </a>
   =
   <i>
    [xstart
   </i>
   ,
   <i>
    xspacing]
   </i>
   | ,
   <a class="MCXref_Heading_0" href="#M_824365677_888789">
    XVALUES
   </a>
   =
   <i>
    array
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#M_824365677_888791">
    YGRID
   </a>
   =
   <i>
    [ystart
   </i>
   ,
   <i>
    yspacing]
   </i>
   | ,
   <a class="MCXref_Heading_0" href="#M_824365677_888793">
    YVALUES
   </a>
   =
   <i>
    array
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#M_824365677_888796">
    GS
   </a>
   =
   <i>
    [xspace
   </i>
   ,
   <i>
    yspace]
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#M_824365677_888798">
    BOUNDS
   </a>
   =
   <i>
    [xmin
   </i>
   ,
   <i>
    ymin
   </i>
   ,
   <i>
    xmax
   </i>
   ,
   <i>
    ymax]
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#M_824365677_888800">
    NX
   </a>
   =
   <i>
    value
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#M_824365677_888802">
    NY
   </a>
   =
   <i>
    value
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#M_824365677_888804">
    XOUT
   </a>
   =
   <i>
    vector
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#M_824365677_888806">
    YOUT
   </a>
   =
   <i>
    vector
   </i>
   ] [,&#160;
   <a class="MCXref_Heading_0" href="#M_824365677_888808">
    XPOUT
   </a>
   .
   <a class="MCXref_Heading_0" href="#M_824365677_1119493">
    YPOUT
   </a>
   =
   <i>
    array
   </i>
   ])
  </p>
  <h2 class="API">
   <a name="M_824365677_956518">
   </a>
   <a name="M_824365677_956518_PageTOC_MIN_CURVE_SURF_">
   </a>
   Return Value
  </h2>
  <p>
   This function returns a two-dimensional floating-point array containing the interpolated surface, sampled at the grid points.
  </p>
  <h2 class="API">
   <a name="M_824365677_956267">
   </a>
   <a name="M_824365677_956267_PageTOC_MIN_CURVE_SURF_">
   </a>
   Arguments
  </h2>
  <h3 class="Argument">
   Z, X, Y
  </h3>
  <p>
   Arrays containing the
   <i>
    Z
   </i>
   ,
   <i>
    X
   </i>
   , and
   <i>
    Y
   </i>
   coordinates of the data points on the surface. Points need not be regularly gridded. For regularly gridded input data,
   <i>
    X
   </i>
   and
   <i>
    Y
   </i>
   are not used: the grid spacing is specified via the XGRID and YGRID (or XVALUES and YVALUES) keywords, and
   <i>
    Z
   </i>
   must be a two-dimensional array. For irregular grids, all three parameters must be present and have the same number of elements. If Z is specified as a double-precision value, the computation will be performed in double-precision arithmetic. If the SPHERE keyword is set, X and Y are given in degrees of longitude and latitude, respectively.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   The minimum curvature algorithm requires a work array that is
   <i>
    M
   </i>
   <i style="font-size: 80%;vertical-align: super;">
    2
   </i>
   in size, where
   <i>
    M
   </i>
   is the total number of input data points. On 32-bit platforms, you are therefore limited to input data arrays that have less than approximately 46340 data points, with the exact number depending upon your available memory. Using an input array with too many elements will result in an error.
  </p>
  <h2 class="API">
   <a name="M_824365677_888781">
   </a>
   <a name="M_824365677_888781_PageTOC_MIN_CURVE_SURF_">
   </a>
   Keywords
  </h2>
  <h3 class="Keyword">
   <a name="M_824365677_956696">
   </a>
   <a name="M_824365677_956696_Keywords_MIN_CURVE_SURF__">
   </a>
   CONST
  </h3>
  <p>
   Set this keyword to fit data on the sphere with a constant baseline, otherwise, data on the sphere is fit with a baseline that contains a constant term plus linear X, Y, and Z terms. This keyword has an effect only if SPHERE is set. See Theory above for the formulae.
  </p>
  <h3 class="Keyword">
   <a name="M_824365677_929725">
   </a>
   <a name="M_824365677_929725_Keywords_MIN_CURVE_SURF__">
   </a>
   DOUBLE
  </h3>
  <p>
   Set this keyword to force the computation to be done in double-precision arithmetic. If Z is double precision, the computations will also be done in double precision.
  </p>
  <h3 class="Keyword">
   <a name="M_824365677_956689">
   </a>
   <a name="M_824365677_956689_Keywords_MIN_CURVE_SURF__">
   </a>
   SPHERE
  </h3>
  <p>
   Set this keyword to perform interpolation on the surface of a sphere. The inputs X and Y should be given in degrees of longitude and latitude, respectively.
  </p>
  <h3 class="Keyword">
   <a name="M_824365677_888782">
   </a>
   <a name="M_824365677_888782_Keywords_MIN_CURVE_SURF__">
   </a>
   TPS
  </h3>
  <p>
   Set this keyword to use the thin-plate-spline method. The default is to use the minimum curvature surface method.
  </p>
  <h3>
   <a name="M_824365677_888784_Keywords_MIN_CURVE_SURF__">
   </a>
   Input Grid Description Keywords:
  </h3>
  <h3 class="Keyword">
   <a name="M_824365677_888785">
   </a>
   <a name="M_824365677_888785_Keywords_MIN_CURVE_SURF__">
   </a>
   REGULAR
  </h3>
  <p>
   If set, the
   <i>
    Z
   </i>
   parameter is a two-dimensional array of dimensions (
   <i>
    n,m
   </i>
   ), containing measurements over a regular grid. If any of XGRID, YGRID, XVALUES, or YVALUES are specified, REGULAR is implied. REGULAR is also implied if there is only one parameter,
   <i>
    Z
   </i>
   . If REGULAR is set, and no grid specifications are present, the grid is set to (0, 1, 2, ...).
  </p>
  <h3 class="Keyword">
   <a name="M_824365677_888787">
   </a>
   <a name="M_824365677_888787_Keywords_MIN_CURVE_SURF__">
   </a>
   XGRID
  </h3>
  <p>
   A two-element array, [
   <i>
    xstart
   </i>
   ,
   <i>
    xspacing
   </i>
   ], defining the input grid in the
   <i>
    x
   </i>
   direction. Do not specify both XGRID and XVALUES.
  </p>
  <h3 class="Keyword">
   <a name="M_824365677_888789">
   </a>
   <a name="M_824365677_888789_Keywords_MIN_CURVE_SURF__">
   </a>
   XVALUES
  </h3>
  <p>
   An
   <i>
    n
   </i>
   -element array defining the
   <i>
    x
   </i>
   locations of Z[
   <i>
    i,j
   </i>
   ]. Do not specify both XGRID and XVALUES.
  </p>
  <h3 class="Keyword">
   <a name="M_824365677_888791">
   </a>
   <a name="M_824365677_888791_Keywords_MIN_CURVE_SURF__">
   </a>
   YGRID
  </h3>
  <p>
   A two-element array, [
   <i>
    ystart
   </i>
   ,
   <i>
    yspacing
   </i>
   ], defining the input grid in the
   <i>
    y
   </i>
   direction. Do not specify both YGRID and YVALUES.
  </p>
  <h3 class="Keyword">
   <a name="M_824365677_888793">
   </a>
   <a name="M_824365677_888793_Keywords_MIN_CURVE_SURF__">
   </a>
   YVALUES
  </h3>
  <p>
   An
   <i>
    n
   </i>
   -element array defining the
   <i>
    y
   </i>
   locations of Z[
   <i>
    i,j
   </i>
   ]. Do not specify both YGRID and YVALUES.
  </p>
  <h3>
   <a name="M_824365677_888795_Keywords_MIN_CURVE_SURF__">
   </a>
   Output Grid Description Keywords:
  </h3>
  <h3 class="Keyword">
   <a name="M_824365677_888796">
   </a>
   <a name="M_824365677_888796_Keywords_MIN_CURVE_SURF__">
   </a>
   GS
  </h3>
  <p>
   The output grid spacing. If present, GS must be a two-element vector [
   <i>
    xs, ys
   </i>
   ], where
   <i>
    xs
   </i>
   is the horizontal spacing between grid points and
   <i>
    ys
   </i>
   is the vertical spacing. The default is based on the extents of
   <i>
    x
   </i>
   and
   <i>
    y
   </i>
   . If the grid starts at
   <i>
    x
   </i>
   value
   <i>
    xmin
   </i>
   and ends at
   <i>
    xmax
   </i>
   , then the default horizontal spacing is (
   <i>
    xmax
   </i>
   -
   <i>
    xmin
   </i>
   )/(NX-1).
   <i>
    ys
   </i>
   is computed in the same way. The default grid size, if neither NX or NY are specified, is 26 by 26.
  </p>
  <h3 class="Keyword">
   <a name="M_824365677_888798">
   </a>
   <a name="M_824365677_888798_Keywords_MIN_CURVE_SURF__">
   </a>
   BOUNDS
  </h3>
  <p>
   If present, BOUNDS must be a four-element array containing the grid limits in
   <i>
    x
   </i>
   and
   <i>
    y
   </i>
   of the output grid: [
   <i>
    xmin, ymin, xmax, ymax
   </i>
   ]. If not specified, the grid limits are set to the extent of
   <i>
    x
   </i>
   and
   <i>
    y
   </i>
   .
  </p>
  <h3 class="Keyword">
   <a name="M_824365677_888800">
   </a>
   <a name="M_824365677_888800_Keywords_MIN_CURVE_SURF__">
   </a>
   NX
  </h3>
  <p>
   The output grid size in the
   <i>
    x
   </i>
   direction. NX need not be specified if the size can be inferred from GS and BOUNDS. The default value is 26.
  </p>
  <h3 class="Keyword">
   <a name="M_824365677_888802">
   </a>
   <a name="M_824365677_888802_Keywords_MIN_CURVE_SURF__">
   </a>
   NY
  </h3>
  <p>
   The output grid size in the
   <i>
    y
   </i>
   direction. NY need not be specified if the size can be inferred from GS and BOUNDS. The default value is 26.
  </p>
  <h3 class="Keyword">
   <a name="M_824365677_888804">
   </a>
   <a name="M_824365677_888804_Keywords_MIN_CURVE_SURF__">
   </a>
   XOUT
  </h3>
  <p>
   Use the XOUT keyword to specify a vector containing the output grid
   <i>
    x
   </i>
   values. If this parameter is supplied, GS, BOUNDS, and NX are ignored for the
   <i>
    x
   </i>
   output grid. XOUT allows you to specify irregularly-spaced output grids.
  </p>
  <h3 class="Keyword">
   <a name="M_824365677_888806">
   </a>
   <a name="M_824365677_888806_Keywords_MIN_CURVE_SURF__">
   </a>
   YOUT
  </h3>
  <p>
   Use the YOUT keyword to specify a vector containing the output grid
   <i>
    y
   </i>
   values. If this parameter is supplied, GS, BOUNDS, and NY are ignored for the
   <i>
    y
   </i>
   output grid. YOUT allows you to specify irregularly-spaced output grids.
  </p>
  <h3 class="Keyword">
   <a name="M_824365677_888808">
   </a>
   <a name="M_824365677_888808_Keywords_MIN_CURVE_SURF__">
   </a>
   XPOUT
  </h3>
  <h3 class="Keyword">
   <a name="M_824365677_1119493">
   </a>
   <a name="M_824365677_1119493_Keywords_MIN_CURVE_SURF__">
   </a>
   YPOUT
  </h3>
  <p>
   Use the XPOUT and YPOUT keywords to specify arrays that contain the
   <i>
    x
   </i>
   and
   <i>
    y
   </i>
   values for the output points. If these keywords are used, the output grid need not be regular, and all other output grid parameters are ignored. XPOUT and YPOUT must have the same number of points, which is also the number of points returned in the result.
  </p>
  <h2 class="API">
   <a name="M_824365677_888810">
   </a>
   <a name="M_824365677_888810_PageTOC_MIN_CURVE_SURF_">
   </a>
   Examples
  </h2>
  <h4>
   Example 1: Irregularly gridded cases
  </h4>
  <p class="Code">
   ; Make a random set of points that lie on a Gaussian:
  </p>
  <p class="Code">
   N = 15
  </p>
  <p class="Code">
   X = RANDOMU(seed, N)
  </p>
  <p class="Code">
   Y = RANDOMU(seed, N)
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; The Gaussian:
  </p>
  <p class="Code">
   Z = EXP(-2 * ((X-.5)^2 + (Y-.5)^2))
  </p>
  <p>
   Use a 26 by 26 grid over the rectangle bounding x and y:
  </p>
  <p class="Code">
   ;Get the surface.
  </p>
  <p class="Code">
   R = MIN_CURVE_SURF(Z, X, Y)
  </p>
  <p>
   Alternatively, get a surface over the unit square, with spacing of 0.05:
  </p>
  <p class="Code">
   R = MIN_CURVE_SURF(Z, X, Y, GS=[0.05, 0.05], BOUNDS=[0,0,1,1])
  </p>
  <p>
   Alternatively, get a 10 by 10 surface over the rectangle bounding x and y:
  </p>
  <p class="Code">
   R = MIN_CURVE_SURF(Z, X, Y, NX=10, NY=10)
  </p>
  <h4>
   Example 2: Regularly gridded cases
  </h4>
  <p class="Code">
   ; Make some random data:
   <br />
   z = RANDOMU(seed, 5, 6)
   <br />
   <br />
   ; Interpolate to a 26 x 26 grid:
   <br />
   CONTOUR, MIN_CURVE_SURF(z, /REGULAR)
  </p>
  <h2 class="API">
   <a name="M_824365677_888822">
   </a>
   <a name="M_824365677_888822_PageTOC_MIN_CURVE_SURF_">
   </a>
   Version History
  </h2>
  <table style="width: 499px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
   <col width="91px" />
   <col width="408px" />
   <tbody>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
      <p>
       Pre 4.0
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
      <p>
       Introduced
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <h2 class="API">
   <a name="M_824365677_973005">
   </a>
   <a name="M_824365677_973005_PageTOC_MIN_CURVE_SURF_">
   </a>
   See Also
  </h2>
  <p>
   <a class="MCXref_Heading_0" href="../G/GRID_TPS.html#G_845992557_870369">
    GRID_TPS
   </a>
   ,
   <a class="MCXref_Heading_0" href="../T/TRI_SURF.html#T_809226861_758595">
    TRI_SURF
   </a>
  </p>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>