<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:madcap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" madcap:lastblockdepth="2" madcap:lastheight="135.6667" madcap:lastwidth="592" madcap:disablemasterstylesheet="true" madcap:tocpath="Additional Topics|Medical Imaging in IDL|IDL DICOM Reference|IDLffDicomEx" madcap:medium="non-print" madcap:inpreviewmode="false" madcap:preloadimages="false" madcap:runtimefiletype="Topic" madcap:targettype="WebHelp" lang="en-US" xml:lang="en-US" madcap:pathtohelpsystem="../../../" madcap:helpsystemfilename="idl.xml" madcap:searchtype="Stem">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
   IDLffDicomEx::EnumerateTags
  </title>
  <link href="../../SkinSupport/MadCap.css" rel="stylesheet" />
  <link href="../../Resources/TableStyles/Description.css" rel="stylesheet" />
  <link href="../../Resources/TableStyles/VersionTable.css" rel="stylesheet" />
  <link href="../../Resources/Stylesheets/IDL_style.css" rel="stylesheet" />
  <script src="../../SkinSupport/MadCapAll.js" type="text/javascript">
  </script>
 </head>
 <body>
  <p class="MCWebHelpFramesetLink" style="display: none;">
   <a href="../../../idl_CSH.html#DICOM_Medical/IDL DICOM Reference/IDLffDicomEx__EnumerateTags.html" style="">
    Open topic with navigation
   </a>
  </p>
  <div class="MCBreadcrumbsBox_0">
   <span class="MCBreadcrumbsPrefix">
    <![CDATA[ ]]>
   </span>
   <a class="MCBreadcrumbsLink" href="../../OtherTopics.html">
    Additional Topics
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="../Expanded DICOM Support in IDL/ExpandedDICOMFunctionality.html">
    Medical Imaging in IDL
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <a class="MCBreadcrumbsLink" href="DICOMEX_GETCONFIGFILEPAT.html">
    IDL DICOM Reference
   </a>
   <span class="MCBreadcrumbsDivider">
    &gt;
   </span>
   <span class="MCBreadcrumbs">
    IDLffDicomEx::EnumerateTags
   </span>
  </div>
  <h1 class="ObjMethod">
   IDLffDicomEx::EnumerateTags
  </h1>
  <p>
   The IDLffDicomEx::EnumerateTags function method returns an array of structures representing the contents of the DICOM file. Each structure contains fields relating to values within the DICOM attribute. This method allows you to access the contents of the DICOM file (specified by start and end tags) and output them to the IDL Workbench Output Log window or to a file.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   If the START_TAG and STOP_TAG keywords are not specified, then the return array contains a structure for every DICOM attribute in the file. See the following “Examples” section for sample code.
  </p>
  <h2 class="API">
   <a name="dicom_ex_4010397576_1007156">
   </a>
   <a name="dicom_ex_4010397576_1007156_PageTOC_IDLffDicomEx">
   </a>
   Syntax
  </h2>
  <p class="Syntax">
   <span class="Italic">
    Result
   </span>
   =
   <span class="Italic">
    Obj
   </span>
   -&gt;[
   <a href="IDLffDicomEx.html" class="MCXref_0">
    IDLffDicomEx
   </a>
   ::]EnumerateTags ( [,&#160;
   <a href="#dicom_ex_4010397576_1007258" class="MCXref_0">
    START_TAG
   </a>
   =
   <span class="Italic">
    string
   </span>
   ] [,&#160;
   <a href="#dicom_ex_4010397576_1007264" class="MCXref_0">
    STOP_TAG
   </a>
   =
   <span class="Italic">
    string
   </span>
   ] [,&#160;
   <a href="#dicom_ex_4010397576_1007270" class="MCXref_0">
    COUNT
   </a>
   =
   <span class="Italic">
    variable
   </span>
   ] [,&#160;
   <a href="#dicom_ex_4010397576_1007272" class="MCXref_0">
    FILENAME
   </a>
   =
   <span class="Italic">
    string
   </span>
   ] [,&#160;/
   <a href="#dicom_ex_4010397576_1007274" class="MCXref_0">
    QUIET
   </a>
   ]&#160;)
  </p>
  <h2 class="API">
   <a name="dicom_ex_4010397576_1007158">
   </a>
   <a name="dicom_ex_4010397576_1007158_PageTOC_IDLffDicomEx">
   </a>
   Return Value
  </h2>
  <p>
   Returns an array of structures containing the indicated tag values. The array contains a structure for each tag enumerated by this method. Each structure has the following fields:
  </p>
  <table style="caption-side: bottom;mc-table-style: url('../../Resources/TableStyles/Description.css');margin-left: 0;margin-right: auto;" cellspacing="0" class="TableStyle_Description">
   <caption>
    DICOM Tag Structure Fields
   </caption>
   <col />
   <col />
   <col />
   <thead>
    <tr>
     <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
      <p>
       Field
      </p>
     </td>
     <td class="TableStyle_Description_Head_0_0_RowSep_ColSep">
      <p>
       IDL Data Type
      </p>
     </td>
     <td class="TableStyle_Description_Head_0_0_RowSep_ColEnd">
      <p>
       Description
      </p>
     </td>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       TAG
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       <b>
        String
       </b>
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       A nine character string containing the DICOM attribute tag (for example, ‘0080,0060’). This field always has a valid value. See
       <a href="../DICOM Resources/DICOMAttributes.html">
        DICOM Attributes
       </a>
       DICOM Attributes for a list of tags.
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       DESCRIPTION
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       <b>
        String
       </b>
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       A description of the public tag governed by the DICOM standard. This field is not available for private tags.
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       VR
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       <b>
        String
       </b>
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       A two character string indicating the value representation of the attribute (for example, ‘LO’). This field always has a valid value. See
       <a href="../DICOM Resources/ValueRepresentations.html">
        Value Representations
       </a>
       for more information.
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       LENGTH
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       ULong
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       An unsigned long value indicating the length of the value field of the DICOM attribute in bytes. If the VR field is SQ (a sequence), then the LENGTH field indicates the number of repeating groups in a sequence.
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       VALUECOUNT
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       Long
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       A long integer indicating the number of values in the value field of the DICOM attribute. If the attribute is multi-valued, then the individual values in the VALUE field are separated by a backslash ‘\’.
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       SEQID
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       Long
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       A long integer containing the sequence identifier of the DICOM attribute. This field contains a non-zero value even when the attribute is not a sequence, so that the value contained in this field can be used without error with any IDLffDicomEx method that has a SEQID keyword. Root level tags have identical valid values.
      </p>
      <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
       <span class="autonumber">
        <span>
         <b>
          Note:
         </b>
        </span>
       </span>
       All sequence identifiers are invalidated when you call the
       <a href="IDLffDicomEx__Commit.html" class="MCXref_0">
        IDLffDicomEx::Commit
       </a>
       method. You must use
       <a href="IDLffDicomEx__GetValue.html" class="MCXref_0">
        IDLffDicomEx::GetValue
       </a>
       to re-access sequence identifiers if needed.
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       GROUPNUM
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColSep">
      <p>
       Long
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowSep_ColEnd">
      <p>
       A long integer containing the group number for a tag that is in a repeating group. This value can be used when formatting output to display repeating groups of tags. This value equals 0 for tags not in a repeating group.
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       LEVEL
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColSep">
      <p>
       Long
      </p>
     </td>
     <td class="TableStyle_Description_Body_1_0_RowSep_ColEnd">
      <p>
       A long integer indicating the nesting level of an attribute. A value of 0 indicates the tag is at the root level. A value greater than one indicates the tag is not at the root level. This value can be used to indent tags so there is a visual indication of tags inside sequences or nested sequences.
      </p>
     </td>
    </tr>
    <tr>
     <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
      <p>
       VALUE
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowEnd_ColSep">
      <p>
       <b>
        String
       </b>
      </p>
     </td>
     <td class="TableStyle_Description_Body_0_0_RowEnd_ColEnd">
      <p>
       A string containing the value of the DICOM attribute tag with the following caveats:
      </p>
      <ul>
       <li value="1">
        For tags with multiple values, the values are separated by a backslash character (“\”).
       </li>
       <li value="2">
        When the VR field is OB, OW, or OF the value field is not filled in as the tag contains binary data that is not suitable for presentation in a string. Typically the OB and OW tags are used for pixel data.
       </li>
       <li value="3">
        When the VR is SQ then value is not filled in as the value field for a sequence does not contain data. The sequence identifiers for the tags in the sequence are returned in the SEQID field.
       </li>
      </ul>
     </td>
    </tr>
   </tbody>
  </table>
  <h2 class="API">
   <a name="dicom_ex_4010397576_1007255">
   </a>
   <a name="dicom_ex_4010397576_1007255_PageTOC_IDLffDicomEx">
   </a>
   Arguments
  </h2>
  <p>
   None
  </p>
  <h2 class="API">
   <a name="dicom_ex_4010397576_1007257">
   </a>
   <a name="dicom_ex_4010397576_1007257_PageTOC_IDLffDicomEx">
   </a>
   Keywords
  </h2>
  <h3 class="Keyword">
   <a name="dicom_ex_4010397576_1007258">
   </a>
   <a name="dicom_ex_4010397576_1007258_Keywords_IDLffDicomEx">
   </a>
   START_TAG
  </h3>
  <p>
   Set this keyword to a string that identifies the first a DICOM attribute to be enumerated. The START_TAG has the format of
   <span class="Courier">
    'XXXX,XXXX'
   </span>
   indicating the group and element of the attribute. A START_TAG value of
   <span class="Courier">
    '0000,0000'
   </span>
   is valid. See
   <a href="../DICOM Resources/DICOMAttributes.html">
    DICOM Attributes
   </a>
   for a list of tags.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   The DICOM attributes specified for the start and stop tags must be root level tags. These tags can be sequence tags as long as they exist at the root level, but they cannot be tags contained inside a sequence.
  </p>
  <h3 class="Keyword">
   <a name="dicom_ex_4010397576_1007264">
   </a>
   <a name="dicom_ex_4010397576_1007264_Keywords_IDLffDicomEx">
   </a>
   STOP_TAG
  </h3>
  <p>
   Set this keyword to a string that identifies the final DICOM attribute to be enumerated. STOP_TAG must have the format of
   <span class="Courier">
    'XXXX,XXXX'
   </span>
   indicating the group and element of the attribute. A STOP_TAG value of
   <span class="Courier">
    '0000,0000'
   </span>
   is valid. See
   <a href="../DICOM Resources/DICOMAttributes.html">
    DICOM Attributes
   </a>
   for a list of tags.
  </p>
  <p class="Note" madcap:autonum="&lt;b&gt;Note: &lt;/b&gt;">
   <span class="autonumber">
    <span>
     <b>
      Note:
     </b>
    </span>
   </span>
   The DICOM attributes specified for the start and stop tags must be root level tags. These tags can be sequence tags as long as they exist at the root level, but they cannot be tags contained inside a sequence.
  </p>
  <h3 class="Keyword">
   <a name="dicom_ex_4010397576_1007270">
   </a>
   <a name="dicom_ex_4010397576_62428">
   </a>
   COUNT
  </h3>
  <p>
   Set this keyword to a named variable that will contain a long integer indicating the number of structures in the array returned by this method. This equals the number of DICOM attributes for which values are enumerated.
  </p>
  <h3 class="Keyword">
   <a name="dicom_ex_4010397576_1007272">
   </a>
   <a name="dicom_ex_4010397576_74075">
   </a>
   FILENAME
  </h3>
  <p>
   Set this keyword to a string specifying name of the file to which the enumerated tags are to be written. This can either be an absolute path (‘
   <span class="Courier">
    C:\myDicomTags.txt
   </span>
   ’) or simply a filename (‘
   <span class="Courier">
    myDicomTags.txt
   </span>
   ’). When only a filename is provided, the file is saved in the IDL working directory.
  </p>
  <h3 class="Keyword">
   <a name="dicom_ex_4010397576_1007274">
   </a>
   <a name="dicom_ex_4010397576_23915">
   </a>
   QUIET
  </h3>
  <p>
   Set this keyword to suppress the following message in the Output Log window:
  </p>
  <p class="Code">
   “Warning: Skipping tag, unsupported VR type (tag/vr)”
  </p>
  <p>
   This message is displayed when the DICOM file contains a DICOM attribute that has a VR type of UN (unknown). This can happen when a vendor adds a private tag using the UN value representation. See
   <a href="../DICOM Resources/ValueRepresentations.html" target="" title="" alt="" class="MCXref_0">
    Value Representations
   </a>
   for more information.
  </p>
  <h2 class="API">
   <a name="dicom_ex_4010397576_1028596">
   </a>
   <a name="dicom_ex_4010397576_1028596_PageTOC_IDLffDicomEx">
   </a>
   Example
  </h2>
  <p>
   The following code prints all tags in the selected file to the Output Log window and to a file (
   <span class="Courier">
    dicomtags.txt
   </span>
   ) in your working directory. Set the Output Log window to a monospaced font such as Courier to display properly aligned columns.
  </p>
  <p class="Code">
   PRO read_dicomtags_doc
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Select a DICOM file to examine.
  </p>
  <p class="Code">
   sFile = DIALOG_PICKFILE( $
  </p>
  <p class="Code">
   PATH=FILEPATH('',SUBDIRECTORY=['examples','data']), $
  </p>
  <p class="Code">
   TITLE='Select DICOM Patient File', FILTER='*.dcm')
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Open the selected file in read-only mode.
  </p>
  <p class="Code">
   oImg = OBJ_NEW('IDLffDicomEx', sfile)
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Use the EnumerateTags method to access the values of
  </p>
  <p class="Code">
   ; each DICOM attribute. Do not specify start or stop
  </p>
  <p class="Code">
   ; tag values to return all tags. Write the tags to a file
  </p>
  <p class="Code">
   ; in the IDL working directory.
  </p>
  <p class="Code">
   vTags = oImg-&gt;EnumerateTags(COUNT = vTagCnt, $
  </p>
  <p class="Code">
   FILENAME = 'dicomtags.txt')
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Print the tags to the Output Log window:
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Identify the name of the DICOM file and number of tags.
  </p>
  <p class="Code">
   oImg-&gt;GetProperty, FILENAME = vfilename
  </p>
  <p class="Code">
   PRINT, ' Tags in = ', vfilename, ' tag count = ', vTagCnt
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Format the output.
  </p>
  <p class="Code">
   PRINT, FORMAT= $
  </p>
  <p class="Code">
   '(%"%3s, %2s, %12s, %3s, %7s, %3s, %5s, %30s, %50s")', $
  </p>
  <p class="Code">
   'IDX', 'LVL', 'TAG',  'VR', 'LEN', 'CNT', 'SEQID', $
  </p>
  <p class="Code">
   'DESCRIPTION', 'VALUE'
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Cycle through all of the tags.
  </p>
  <p class="Code">
   FOR xx = 0, vTagCnt-1  DO BEGIN
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; If the item is nested within another item, indicate the
  </p>
  <p class="Code">
   ; level using &gt; symbol.
  </p>
  <p class="Code">
   IF (vTags[xx].Level GT 0) THEN BEGIN
  </p>
  <p class="Code">
   &#160;&#160;&#160;&#160;&#160;&#160;vLvl = STRJOIN(REPLICATE('&gt;',vTags[xx].Level))
  </p>
  <p class="Code">
   vtg =  vLvl + vTags[xx].Tag
  </p>
  <p class="Code">
   ENDIF ELSE BEGIN
  </p>
  <p class="Code">
   vtg = vTags[xx].Tag
  </p>
  <p class="Code">
   ENDELSE
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; If the tags are in a group, indicate this.
  </p>
  <p class="Code">
   IF (vTags[xx].GroupNum GT 0) THEN BEGIN
  </p>
  <p class="Code">
   PRINT, FORMAT='(%"%15s, %1d")', 'Group', vTags[xx].GroupNum
  </p>
  <p class="Code">
   ENDIF
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Print the fields of the structure.
  </p>
  <p class="Code">
   PRINT, FORMAT= $
  </p>
  <p class="Code">
   '(%"%3d, %2d, %12s, %3s, %7d, %3d, %5d, %30s, %50s")', $
  </p>
  <p class="Code">
   xx, vTags[xx].Level, vtg, vTags[xx].VR, vTags[xx].Length, $
  </p>
  <p class="Code">
   vTags[xx].ValueCount, vTags[xx].SeqId, $
  </p>
  <p class="Code">
   vTags[xx].Description, vTags[xx].Value
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ENDFOR
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   ; Clean up references.
  </p>
  <p class="Code">
   OBJ_DESTROY, oImg
  </p>
  <p class="Code">
   &#160;
  </p>
  <p class="Code">
   END
  </p>
  <h2 class="API">
   <a name="dicom_ex_4010397576_1036884">
   </a>
   <a name="dicom_ex_4010397576_1036884_PageTOC_IDLffDicomEx">
   </a>
   Version History
  </h2>
  <table style="width: 499px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/VersionTable.css');" cellspacing="0" class="TableStyle_VersionTable">
   <col width="91px" />
   <col width="408px" />
   <tbody>
    <tr>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColSep">
      <p>
       6.1
      </p>
     </td>
     <td class="TableStyle_VersionTable_Body_0_0_RowEnd_ColEnd">
      <p>
       Introduced
      </p>
     </td>
    </tr>
   </tbody>
  </table>
  <div class="mp_footer">
   Copyright ©
   <span class="DocumentTitleCopyrightYear">
    2012
   </span>
   <![CDATA[ ]]>
   <span class="DocumentTitleCopyrightCompanyName">
    Exelis Visual Information Solutions, Inc.
   </span>
   All Rights Reserved.
  </div>
  <script type="text/javascript" src="../../SkinSupport/MadCapBodyEnd.js">
  </script>
 </body>
</html>